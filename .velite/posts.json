[{"slug":"blog/building_api_with_next.js","code":"const{Fragment:e,jsx:l,jsxs:n}=arguments[0];function _createMdxContent(r){const o={a:\"a\",blockquote:\"blockquote\",code:\"code\",figure:\"figure\",h2:\"h2\",img:\"img\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...r.components};return n(e,{children:[n(o.p,{children:[\"Next.js uses \",l(o.strong,{children:\"file-system based routing\"}),\", meaning you can use folders and files to define routes. This page will guide you through how to create layouts and pages, and link between them.\"]}),\"\\n\",l(o.h2,{id:\"creating-a-page\",children:l(o.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#creating-a-page\",children:\"Creating a page\"})}),\"\\n\",n(o.p,{children:[\"A \",l(o.strong,{children:\"page\"}),\" is UI that is rendered on a specific route. To create a page, add a \",n(o.a,{href:\"https://nextjs.org/docs/app/api-reference/file-conventions/page\",children:[l(o.code,{children:\"page\"}),\" file\"]}),\" inside the \",l(o.code,{children:\"app\"}),\" directory and default export a React component. For example, to create an index page (\",l(o.code,{children:\"/\"}),\"):\"]}),\"\\n\",l(o.p,{children:l(o.img,{src:\"https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Fdocs%2Flight%2Fpage-special-file.png&w=3840&q=75\",alt:\"page.js special file\"})}),\"\\n\",l(o.figure,{\"data-rehype-pretty-code-figure\":\"\",children:l(o.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",children:n(o.code,{\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"export\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" default\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" function\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" Page\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  return\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" <\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"h1\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\">\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"Hello\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\" Next\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\".\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"js\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"!</\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"h1\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",l(o.h2,{id:\"creating-a-layout\",children:l(o.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#creating-a-layout\",children:\"Creating a layout\"})}),\"\\n\",n(o.p,{children:[\"A layout is UI that is \",l(o.strong,{children:\"shared\"}),\" between multiple pages. On navigation, layouts preserve state, remain interactive, and do not rerender.\"]}),\"\\n\",n(o.p,{children:[\"You can define a layout by default exporting a React component from a \",n(o.a,{href:\"https://nextjs.org/docs/app/api-reference/file-conventions/layout\",children:[l(o.code,{children:\"layout\"}),\" file\"]}),\". The component should accept a \",l(o.code,{children:\"children\"}),\" prop which can be a page or another \",l(o.a,{href:\"https://nextjs.org/docs/app/getting-started/layouts-and-pages#nesting-layouts\",children:\"layout\"}),\".\"]}),\"\\n\",n(o.p,{children:[\"For example, to create a layout that accepts your index page as child, add a \",l(o.code,{children:\"layout\"}),\" file inside the \",l(o.code,{children:\"app\"}),\" directory:\"]}),\"\\n\",l(o.p,{children:l(o.img,{src:\"https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Fdocs%2Flight%2Flayout-special-file.png&w=3840&q=75\",alt:\"layout.js special file\"})}),\"\\n\",l(o.p,{children:\"app/layout.tsx\"}),\"\\n\",l(o.figure,{\"data-rehype-pretty-code-figure\":\"\",children:l(o.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",children:n(o.code,{\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"export\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" default\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" function\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" DashboardLayout\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"({\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"  children\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}: {\"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#E06C75\"},children:\"  children\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\": \"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"React\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\".\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"ReactNode\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}) {\"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  return\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" (\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"    <\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"html\"}),l(o.span,{style:{color:\"#E06C75\"},children:\" lang\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=\"}),l(o.span,{style:{color:\"#98C379\"},children:'\"en\"'}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"      <\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"body\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"        {\"}),l(o.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"/* Layout UI */\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"        {\"}),l(o.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"/* Place children where you want to render a page or nested layout */\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"        <\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"main\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\">{\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"children\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"</\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"main\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"      </\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"body\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"    </\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"html\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"  )\"})}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",n(o.p,{children:[\"The layout above is called a \",l(o.a,{href:\"https://nextjs.org/docs/app/api-reference/file-conventions/layout#root-layouts\",children:\"root layout\"}),\" because it's defined at the root of the \",l(o.code,{children:\"app\"}),\" directory. The root layout is \",l(o.strong,{children:\"required\"}),\" and must contain \",l(o.code,{children:\"html\"}),\" and \",l(o.code,{children:\"body\"}),\" tags.\"]}),\"\\n\",l(o.h2,{id:\"creating-a-nested-route\",children:l(o.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#creating-a-nested-route\",children:\"Creating a nested route\"})}),\"\\n\",n(o.p,{children:[\"A nested route is a route composed of multiple URL segments. For example, the \",l(o.code,{children:\"/blog/[slug]\"}),\" route is composed of three segments:\"]}),\"\\n\",n(o.ul,{children:[\"\\n\",n(o.li,{children:[l(o.code,{children:\"/\"}),\" (Root Segment)\"]}),\"\\n\",n(o.li,{children:[l(o.code,{children:\"blog\"}),\" (Segment)\"]}),\"\\n\",n(o.li,{children:[l(o.code,{children:\"[slug]\"}),\" (Leaf Segment)\"]}),\"\\n\"]}),\"\\n\",l(o.p,{children:\"In Next.js:\"}),\"\\n\",n(o.ul,{children:[\"\\n\",n(o.li,{children:[l(o.strong,{children:\"Folders\"}),\" are used to define the route segments that map to URL segments.\"]}),\"\\n\",n(o.li,{children:[l(o.strong,{children:\"Files\"}),\" (like \",l(o.code,{children:\"page\"}),\" and \",l(o.code,{children:\"layout\"}),\") are used to create UI that is shown for a segment.\"]}),\"\\n\"]}),\"\\n\",n(o.p,{children:[\"To create nested routes, you can nest folders inside each other. For example, to add a route for \",l(o.code,{children:\"/blog\"}),\", create a folder called \",l(o.code,{children:\"blog\"}),\" in the \",l(o.code,{children:\"app\"}),\" directory. Then, to make \",l(o.code,{children:\"/blog\"}),\" publicly accessible, add a \",l(o.code,{children:\"page\"}),\" file:\"]}),\"\\n\",l(o.p,{children:l(o.img,{src:\"https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Fdocs%2Flight%2Fblog-nested-route.png&w=3840&q=75\",alt:\"File hierarchy showing blog folder and a page.js file\"})}),\"\\n\",l(o.p,{children:\"app/blog/page.tsx\"}),\"\\n\",l(o.figure,{\"data-rehype-pretty-code-figure\":\"\",children:l(o.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",children:n(o.code,{\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"import\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" { \"}),l(o.span,{style:{color:\"#E06C75\"},children:\"getPosts\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" } \"}),l(o.span,{style:{color:\"#C678DD\"},children:\"from\"}),l(o.span,{style:{color:\"#98C379\"},children:\" '@/lib/posts'\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"import\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" { \"}),l(o.span,{style:{color:\"#E06C75\"},children:\"Post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" } \"}),l(o.span,{style:{color:\"#C678DD\"},children:\"from\"}),l(o.span,{style:{color:\"#98C379\"},children:\" '@/ui/post'\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\" \"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"export\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" default\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" async\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" function\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" Page\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  const\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\" posts\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\" =\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" await\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" getPosts\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"()\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\" \"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  return\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" (\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"    <\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"ul\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"      {\"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"posts\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\".\"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"map\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"((\"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\") \"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=>\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" (\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"        <\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"Post\"}),l(o.span,{style:{color:\"#E06C75\"},children:\" key\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"{post.\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"id\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"} \"}),l(o.span,{style:{color:\"#E06C75\"},children:\"post\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"{\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"} \"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"/>\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"      ))}\"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"    </\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"ul\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"  )\"})}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",n(o.p,{children:[\"You can continue nesting folders to create nested routes. For example, to create a route for a specific blog post, create a new \",l(o.code,{children:\"[slug]\"}),\" folder inside \",l(o.code,{children:\"blog\"}),\" and add a \",l(o.code,{children:\"page\"}),\" file:\"]}),\"\\n\",l(o.p,{children:l(o.img,{src:\"https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Fdocs%2Flight%2Fblog-post-nested-route.png&w=3840&q=75\",alt:\"File hierarchy showing blog folder with a nested slug folder and a page.js file\"})}),\"\\n\",l(o.p,{children:\"app/blog/[slug]/page.tsx\"}),\"\\n\",l(o.p,{children:\"TypeScript\"}),\"\\n\",l(o.pre,{children:l(o.code,{children:\"function generateStaticParams() {}\\r\\n \\r\\nexport default function Page() {\\r\\n  return <h1>Hello, Blog Post Page!</h1>\\r\\n}\\n\"})}),\"\\n\",n(o.blockquote,{children:[\"\\n\",n(o.p,{children:[l(o.strong,{children:\"Good to know\"}),\": Wrapping a folder name in square brackets (e.g. \",l(o.code,{children:\"[slug]\"}),\") creates a special \",l(o.a,{href:\"https://nextjs.org/docs/app/building-your-application/routing/dynamic-routes\",children:\"dynamic route segment\"}),\" used to generate multiple pages from data. This is useful for blog posts, product pages, etc.\"]}),\"\\n\"]}),\"\\n\",l(o.h2,{id:\"nesting-layouts\",children:l(o.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#nesting-layouts\",children:\"Nesting layouts\"})}),\"\\n\",n(o.p,{children:[\"By default, layouts in the folder hierarchy are also nested, which means they wrap child layouts via their \",l(o.code,{children:\"children\"}),\" prop. You can nest layouts by adding \",l(o.code,{children:\"layout\"}),\" inside specific route segments (folders).\"]}),\"\\n\",n(o.p,{children:[\"For example, to create a layout for the \",l(o.code,{children:\"/blog\"}),\" route, add a new \",l(o.code,{children:\"layout\"}),\" file inside the \",l(o.code,{children:\"blog\"}),\" folder.\"]}),\"\\n\",l(o.p,{children:l(o.img,{src:\"https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Fdocs%2Flight%2Fnested-layouts.png&w=3840&q=75\",alt:\"File hierarchy showing root layout wrapping the blog layout\"})}),\"\\n\",l(o.p,{children:\"app/blog/layout.tsx\"}),\"\\n\",l(o.figure,{\"data-rehype-pretty-code-figure\":\"\",children:l(o.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",children:n(o.code,{\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"export\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" default\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" function\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" BlogLayout\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"({\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"  children\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}: {\"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#E06C75\"},children:\"  children\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\": \"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"React\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\".\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"ReactNode\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}) {\"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  return\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" <\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"section\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\">{\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"children\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"</\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"section\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",n(o.p,{children:[\"If you were to combine the two layouts above, the root layout (\",l(o.code,{children:\"app/layout.js\"}),\") would wrap the blog layout (\",l(o.code,{children:\"app/blog/layout.js\"}),\"), which would wrap the blog (\",l(o.code,{children:\"app/blog/page.js\"}),\") and blog post page (\",l(o.code,{children:\"app/blog/[slug]/page.js\"}),\").\"]}),\"\\n\",l(o.h2,{id:\"linking-between-pages\",children:l(o.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#linking-between-pages\",children:\"Linking between pages\"})}),\"\\n\",n(o.p,{children:[\"You can use the \",l(o.a,{href:\"https://nextjs.org/docs/app/api-reference/components/link\",children:\"component\"}),\" to navigate between routes. \",l(o.code,{children:\"<Link>\"}),\" is a built-in Next.js component that extends the HTML \",l(o.code,{children:\"<a>\"}),\" tag to provide prefetching and client-side navigation.\"]}),\"\\n\",n(o.p,{children:[\"For example, to generate a list of blog posts, import \",l(o.code,{children:\"<Link>\"}),\" from \",l(o.code,{children:\"next/link\"}),\" and pass a \",l(o.code,{children:\"href\"}),\" prop to the component:\"]}),\"\\n\",l(o.p,{children:\"app/ui/post.tsx\"}),\"\\n\",l(o.figure,{\"data-rehype-pretty-code-figure\":\"\",children:l(o.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",children:n(o.code,{\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"import\"}),l(o.span,{style:{color:\"#E06C75\"},children:\" Link\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" from\"}),l(o.span,{style:{color:\"#98C379\"},children:\" 'next/link'\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\" \"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"export\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" default\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" async\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" function\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" Post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"({ \"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" }) {\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  const\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\" posts\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\" =\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" await\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" getPosts\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"()\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\" \"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  return\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" (\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"    <\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"ul\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"      {\"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"posts\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\".\"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"map\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"((\"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\") \"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=>\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" (\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"        <\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"li\"}),l(o.span,{style:{color:\"#E06C75\"},children:\" key\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"{post.\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"slug\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"          <\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"Link\"}),l(o.span,{style:{color:\"#E06C75\"},children:\" href\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"{\"}),l(o.span,{style:{color:\"#98C379\"},children:\"`/blog/\"}),l(o.span,{style:{color:\"#C678DD\"},children:\"${\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\".\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"slug\"}),l(o.span,{style:{color:\"#C678DD\"},children:\"}\"}),l(o.span,{style:{color:\"#98C379\"},children:\"`\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"{post.\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"title\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"</\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"Link\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"        </\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"li\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"      ))}\"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"    </\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"ul\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"  )\"})}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",n(o.p,{children:[l(o.code,{children:\"<Link>\"}),\" is the primary and recommended way to navigate between routes in your Next.js application. However, you can also use the \",n(o.a,{href:\"https://nextjs.org/docs/app/api-reference/functions/use-router\",children:[l(o.code,{children:\"useRouter\"}),\" hook\"]}),\" for more advanced navigation.\"]})]})}return{default:function(e={}){const{wrapper:n}=e.components||{};return n?l(n,{...e,children:l(_createMdxContent,{...e})}):_createMdxContent(e)}};","title":"How to create layouts and pages","description":"复制自next.js","date":"2025-03-30T00:00:00.000Z","published":true,"body":"const{Fragment:e,jsx:l,jsxs:n}=arguments[0];function _createMdxContent(r){const o={a:\"a\",blockquote:\"blockquote\",code:\"code\",figure:\"figure\",h2:\"h2\",img:\"img\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...r.components};return n(e,{children:[n(o.p,{children:[\"Next.js uses \",l(o.strong,{children:\"file-system based routing\"}),\", meaning you can use folders and files to define routes. This page will guide you through how to create layouts and pages, and link between them.\"]}),\"\\n\",l(o.h2,{id:\"creating-a-page\",children:l(o.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#creating-a-page\",children:\"Creating a page\"})}),\"\\n\",n(o.p,{children:[\"A \",l(o.strong,{children:\"page\"}),\" is UI that is rendered on a specific route. To create a page, add a \",n(o.a,{href:\"https://nextjs.org/docs/app/api-reference/file-conventions/page\",children:[l(o.code,{children:\"page\"}),\" file\"]}),\" inside the \",l(o.code,{children:\"app\"}),\" directory and default export a React component. For example, to create an index page (\",l(o.code,{children:\"/\"}),\"):\"]}),\"\\n\",l(o.p,{children:l(o.img,{src:\"https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Fdocs%2Flight%2Fpage-special-file.png&w=3840&q=75\",alt:\"page.js special file\"})}),\"\\n\",l(o.figure,{\"data-rehype-pretty-code-figure\":\"\",children:l(o.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",children:n(o.code,{\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"export\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" default\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" function\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" Page\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  return\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" <\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"h1\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\">\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"Hello\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\" Next\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\".\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"js\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"!</\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"h1\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",l(o.h2,{id:\"creating-a-layout\",children:l(o.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#creating-a-layout\",children:\"Creating a layout\"})}),\"\\n\",n(o.p,{children:[\"A layout is UI that is \",l(o.strong,{children:\"shared\"}),\" between multiple pages. On navigation, layouts preserve state, remain interactive, and do not rerender.\"]}),\"\\n\",n(o.p,{children:[\"You can define a layout by default exporting a React component from a \",n(o.a,{href:\"https://nextjs.org/docs/app/api-reference/file-conventions/layout\",children:[l(o.code,{children:\"layout\"}),\" file\"]}),\". The component should accept a \",l(o.code,{children:\"children\"}),\" prop which can be a page or another \",l(o.a,{href:\"https://nextjs.org/docs/app/getting-started/layouts-and-pages#nesting-layouts\",children:\"layout\"}),\".\"]}),\"\\n\",n(o.p,{children:[\"For example, to create a layout that accepts your index page as child, add a \",l(o.code,{children:\"layout\"}),\" file inside the \",l(o.code,{children:\"app\"}),\" directory:\"]}),\"\\n\",l(o.p,{children:l(o.img,{src:\"https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Fdocs%2Flight%2Flayout-special-file.png&w=3840&q=75\",alt:\"layout.js special file\"})}),\"\\n\",l(o.p,{children:\"app/layout.tsx\"}),\"\\n\",l(o.figure,{\"data-rehype-pretty-code-figure\":\"\",children:l(o.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",children:n(o.code,{\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"export\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" default\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" function\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" DashboardLayout\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"({\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"  children\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}: {\"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#E06C75\"},children:\"  children\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\": \"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"React\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\".\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"ReactNode\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}) {\"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  return\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" (\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"    <\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"html\"}),l(o.span,{style:{color:\"#E06C75\"},children:\" lang\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=\"}),l(o.span,{style:{color:\"#98C379\"},children:'\"en\"'}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"      <\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"body\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"        {\"}),l(o.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"/* Layout UI */\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"        {\"}),l(o.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"/* Place children where you want to render a page or nested layout */\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"        <\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"main\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\">{\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"children\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"</\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"main\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"      </\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"body\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"    </\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"html\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"  )\"})}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",n(o.p,{children:[\"The layout above is called a \",l(o.a,{href:\"https://nextjs.org/docs/app/api-reference/file-conventions/layout#root-layouts\",children:\"root layout\"}),\" because it's defined at the root of the \",l(o.code,{children:\"app\"}),\" directory. The root layout is \",l(o.strong,{children:\"required\"}),\" and must contain \",l(o.code,{children:\"html\"}),\" and \",l(o.code,{children:\"body\"}),\" tags.\"]}),\"\\n\",l(o.h2,{id:\"creating-a-nested-route\",children:l(o.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#creating-a-nested-route\",children:\"Creating a nested route\"})}),\"\\n\",n(o.p,{children:[\"A nested route is a route composed of multiple URL segments. For example, the \",l(o.code,{children:\"/blog/[slug]\"}),\" route is composed of three segments:\"]}),\"\\n\",n(o.ul,{children:[\"\\n\",n(o.li,{children:[l(o.code,{children:\"/\"}),\" (Root Segment)\"]}),\"\\n\",n(o.li,{children:[l(o.code,{children:\"blog\"}),\" (Segment)\"]}),\"\\n\",n(o.li,{children:[l(o.code,{children:\"[slug]\"}),\" (Leaf Segment)\"]}),\"\\n\"]}),\"\\n\",l(o.p,{children:\"In Next.js:\"}),\"\\n\",n(o.ul,{children:[\"\\n\",n(o.li,{children:[l(o.strong,{children:\"Folders\"}),\" are used to define the route segments that map to URL segments.\"]}),\"\\n\",n(o.li,{children:[l(o.strong,{children:\"Files\"}),\" (like \",l(o.code,{children:\"page\"}),\" and \",l(o.code,{children:\"layout\"}),\") are used to create UI that is shown for a segment.\"]}),\"\\n\"]}),\"\\n\",n(o.p,{children:[\"To create nested routes, you can nest folders inside each other. For example, to add a route for \",l(o.code,{children:\"/blog\"}),\", create a folder called \",l(o.code,{children:\"blog\"}),\" in the \",l(o.code,{children:\"app\"}),\" directory. Then, to make \",l(o.code,{children:\"/blog\"}),\" publicly accessible, add a \",l(o.code,{children:\"page\"}),\" file:\"]}),\"\\n\",l(o.p,{children:l(o.img,{src:\"https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Fdocs%2Flight%2Fblog-nested-route.png&w=3840&q=75\",alt:\"File hierarchy showing blog folder and a page.js file\"})}),\"\\n\",l(o.p,{children:\"app/blog/page.tsx\"}),\"\\n\",l(o.figure,{\"data-rehype-pretty-code-figure\":\"\",children:l(o.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",children:n(o.code,{\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"import\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" { \"}),l(o.span,{style:{color:\"#E06C75\"},children:\"getPosts\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" } \"}),l(o.span,{style:{color:\"#C678DD\"},children:\"from\"}),l(o.span,{style:{color:\"#98C379\"},children:\" '@/lib/posts'\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"import\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" { \"}),l(o.span,{style:{color:\"#E06C75\"},children:\"Post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" } \"}),l(o.span,{style:{color:\"#C678DD\"},children:\"from\"}),l(o.span,{style:{color:\"#98C379\"},children:\" '@/ui/post'\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\" \"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"export\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" default\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" async\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" function\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" Page\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  const\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\" posts\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\" =\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" await\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" getPosts\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"()\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\" \"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  return\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" (\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"    <\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"ul\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"      {\"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"posts\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\".\"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"map\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"((\"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\") \"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=>\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" (\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"        <\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"Post\"}),l(o.span,{style:{color:\"#E06C75\"},children:\" key\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"{post.\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"id\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"} \"}),l(o.span,{style:{color:\"#E06C75\"},children:\"post\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"{\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"} \"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"/>\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"      ))}\"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"    </\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"ul\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"  )\"})}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",n(o.p,{children:[\"You can continue nesting folders to create nested routes. For example, to create a route for a specific blog post, create a new \",l(o.code,{children:\"[slug]\"}),\" folder inside \",l(o.code,{children:\"blog\"}),\" and add a \",l(o.code,{children:\"page\"}),\" file:\"]}),\"\\n\",l(o.p,{children:l(o.img,{src:\"https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Fdocs%2Flight%2Fblog-post-nested-route.png&w=3840&q=75\",alt:\"File hierarchy showing blog folder with a nested slug folder and a page.js file\"})}),\"\\n\",l(o.p,{children:\"app/blog/[slug]/page.tsx\"}),\"\\n\",l(o.p,{children:\"TypeScript\"}),\"\\n\",l(o.pre,{children:l(o.code,{children:\"function generateStaticParams() {}\\r\\n \\r\\nexport default function Page() {\\r\\n  return <h1>Hello, Blog Post Page!</h1>\\r\\n}\\n\"})}),\"\\n\",n(o.blockquote,{children:[\"\\n\",n(o.p,{children:[l(o.strong,{children:\"Good to know\"}),\": Wrapping a folder name in square brackets (e.g. \",l(o.code,{children:\"[slug]\"}),\") creates a special \",l(o.a,{href:\"https://nextjs.org/docs/app/building-your-application/routing/dynamic-routes\",children:\"dynamic route segment\"}),\" used to generate multiple pages from data. This is useful for blog posts, product pages, etc.\"]}),\"\\n\"]}),\"\\n\",l(o.h2,{id:\"nesting-layouts\",children:l(o.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#nesting-layouts\",children:\"Nesting layouts\"})}),\"\\n\",n(o.p,{children:[\"By default, layouts in the folder hierarchy are also nested, which means they wrap child layouts via their \",l(o.code,{children:\"children\"}),\" prop. You can nest layouts by adding \",l(o.code,{children:\"layout\"}),\" inside specific route segments (folders).\"]}),\"\\n\",n(o.p,{children:[\"For example, to create a layout for the \",l(o.code,{children:\"/blog\"}),\" route, add a new \",l(o.code,{children:\"layout\"}),\" file inside the \",l(o.code,{children:\"blog\"}),\" folder.\"]}),\"\\n\",l(o.p,{children:l(o.img,{src:\"https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Fdocs%2Flight%2Fnested-layouts.png&w=3840&q=75\",alt:\"File hierarchy showing root layout wrapping the blog layout\"})}),\"\\n\",l(o.p,{children:\"app/blog/layout.tsx\"}),\"\\n\",l(o.figure,{\"data-rehype-pretty-code-figure\":\"\",children:l(o.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",children:n(o.code,{\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"export\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" default\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" function\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" BlogLayout\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"({\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"  children\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}: {\"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#E06C75\"},children:\"  children\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\": \"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"React\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\".\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"ReactNode\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}) {\"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  return\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" <\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"section\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\">{\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"children\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"</\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"section\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",n(o.p,{children:[\"If you were to combine the two layouts above, the root layout (\",l(o.code,{children:\"app/layout.js\"}),\") would wrap the blog layout (\",l(o.code,{children:\"app/blog/layout.js\"}),\"), which would wrap the blog (\",l(o.code,{children:\"app/blog/page.js\"}),\") and blog post page (\",l(o.code,{children:\"app/blog/[slug]/page.js\"}),\").\"]}),\"\\n\",l(o.h2,{id:\"linking-between-pages\",children:l(o.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#linking-between-pages\",children:\"Linking between pages\"})}),\"\\n\",n(o.p,{children:[\"You can use the \",l(o.a,{href:\"https://nextjs.org/docs/app/api-reference/components/link\",children:\"component\"}),\" to navigate between routes. \",l(o.code,{children:\"<Link>\"}),\" is a built-in Next.js component that extends the HTML \",l(o.code,{children:\"<a>\"}),\" tag to provide prefetching and client-side navigation.\"]}),\"\\n\",n(o.p,{children:[\"For example, to generate a list of blog posts, import \",l(o.code,{children:\"<Link>\"}),\" from \",l(o.code,{children:\"next/link\"}),\" and pass a \",l(o.code,{children:\"href\"}),\" prop to the component:\"]}),\"\\n\",l(o.p,{children:\"app/ui/post.tsx\"}),\"\\n\",l(o.figure,{\"data-rehype-pretty-code-figure\":\"\",children:l(o.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",children:n(o.code,{\"data-language\":\"ts\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"import\"}),l(o.span,{style:{color:\"#E06C75\"},children:\" Link\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" from\"}),l(o.span,{style:{color:\"#98C379\"},children:\" 'next/link'\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\" \"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"export\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" default\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" async\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" function\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" Post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"({ \"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" }) {\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  const\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\" posts\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\" =\"}),l(o.span,{style:{color:\"#C678DD\"},children:\" await\"}),l(o.span,{style:{color:\"#61AFEF\"},children:\" getPosts\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"()\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\" \"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#C678DD\"},children:\"  return\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" (\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"    <\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"ul\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#ABB2BF\"},children:\"      {\"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"posts\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\".\"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"map\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"((\"}),l(o.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\") \"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=>\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\" (\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"        <\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"li\"}),l(o.span,{style:{color:\"#E06C75\"},children:\" key\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"{post.\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"slug\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"          <\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"Link\"}),l(o.span,{style:{color:\"#E06C75\"},children:\" href\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"=\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"{\"}),l(o.span,{style:{color:\"#98C379\"},children:\"`/blog/\"}),l(o.span,{style:{color:\"#C678DD\"},children:\"${\"}),l(o.span,{style:{color:\"#E5C07B\"},children:\"post\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\".\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"slug\"}),l(o.span,{style:{color:\"#C678DD\"},children:\"}\"}),l(o.span,{style:{color:\"#98C379\"},children:\"`\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"{post.\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"title\"}),l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\"</\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"Link\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"        </\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"li\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"      ))}\"})}),\"\\n\",n(o.span,{\"data-line\":\"\",children:[l(o.span,{style:{color:\"#56B6C2\"},children:\"    </\"}),l(o.span,{style:{color:\"#E06C75\"},children:\"ul\"}),l(o.span,{style:{color:\"#56B6C2\"},children:\">\"})]}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"  )\"})}),\"\\n\",l(o.span,{\"data-line\":\"\",children:l(o.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",n(o.p,{children:[l(o.code,{children:\"<Link>\"}),\" is the primary and recommended way to navigate between routes in your Next.js application. However, you can also use the \",n(o.a,{href:\"https://nextjs.org/docs/app/api-reference/functions/use-router\",children:[l(o.code,{children:\"useRouter\"}),\" hook\"]}),\" for more advanced navigation.\"]})]})}return{default:function(e={}){const{wrapper:n}=e.components||{};return n?l(n,{...e,children:l(_createMdxContent,{...e})}):_createMdxContent(e)}};","slugAsParams":"building_api_with_next.js"},{"slug":"blog/hello","code":"const{Fragment:l,jsx:e,jsxs:n}=arguments[0];function _createMdxContent(r){const c={a:\"a\",code:\"code\",figure:\"figure\",h2:\"h2\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...r.components},{Callout:s}=c;return s||function(l,e){throw new Error(\"Expected \"+(e?\"component\":\"object\")+\" `\"+l+\"` to be defined: you likely forgot to import, pass, or provide it.\")}(\"Callout\",!0),n(l,{children:[e(c.p,{children:\"对于一些不是由用户直接触发的事件， 比如元素从不可见到可见、元素大小的改变、元素的属性和子节点的修改等，这类事件如何监听呢？\"}),\"\\n\",e(c.p,{children:\"浏览器提供了 5 种 Observer 来监听这些变动：MutationObserver、IntersectionObserver、PerformanceObserver、ResizeObserver、ReportingObserver。\"}),\"\\n\",e(c.h2,{id:\"intersectionobserver\",children:e(c.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#intersectionobserver\",children:\"IntersectionObserver\"})}),\"\\n\",e(c.p,{children:\"IntersectionObserver：监听一个元素从不可见到可见，从可见到不可见。\"}),\"\\n\",e(s,{type:\"warning\",children:e(c.p,{children:\"IntersectionObserver 可以监听一个元素和可视区域相交部分的比例，然后在可视比例达到某个阈值的时候触发回调。\"})}),\"\\n\",e(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:e(c.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"one-dark-pro\",children:n(c.code,{\"data-language\":\"html\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"style\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#61AFEF\"},children:\"    #box1\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#61AFEF\"},children:\"    #box2\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      width: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"100\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"px\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      height: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"100\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"px\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      background: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"blue\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      color: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"#fff\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      position: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"relative\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"    }\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#61AFEF\"},children:\"    #box1\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      top: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"500\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"px\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"    }\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#61AFEF\"},children:\"    #box2\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      top: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"800\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"px\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"    }\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"  </\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"style\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"div\"}),e(c.span,{style:{color:\"#D19A66\"},children:\" id\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"=\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"box1\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">BOX111</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"div\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"div\"}),e(c.span,{style:{color:\"#D19A66\"},children:\" id\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"=\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"box2\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">BOX222</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"div\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"script\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"    const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" intersectionObserver\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" new\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" IntersectionObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"((\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"entries\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\") \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"=>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"      entries\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"forEach\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"entry\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" =>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"        console\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"info\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"entry\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"isIntersecting\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\",\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"entry\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"target\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\",\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"entry\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"intersectionRatio\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\")\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"      });\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"    },{\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"threshold\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\":[\"}),e(c.span,{style:{color:\"#D19A66\"},children:\"0.5\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\",\"}),e(c.span,{style:{color:\"#D19A66\"},children:\"1\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"]} \"}),e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// 可见比例为0.5 和1触发回调\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"    const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" box1\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" document\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"getElementById\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:\"'box1'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"    const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" box2\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" document\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"getElementById\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:\"'box2'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"    intersectionObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"observe\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"box1\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"    intersectionObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"observe\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"box2\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"script\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]})]})})}),\"\\n\",e(c.h2,{id:\"mutationobserver\",children:e(c.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#mutationobserver\",children:\"MutationObserver\"})}),\"\\n\",e(c.p,{children:e(c.strong,{children:\"MutationObserver 可以监听对元素的属性的修改、对它的子节点的增删改。\"})}),\"\\n\",e(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:e(c.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"one-dark-pro\",children:n(c.code,{\"data-language\":\"js\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Select the node that will be observed for mutations\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" targetNode\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" document\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"getElementById\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"some-id\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Options for the observer (which mutations to observe)\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" config\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" { \"}),e(c.span,{style:{color:\"#E06C75\"},children:\"attributes\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\": \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"true\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#E06C75\"},children:\"childList\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\": \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"true\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#E06C75\"},children:\"subtree\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\": \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"true\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" };\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Callback function to execute when mutations are observed\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" callback\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"mutationList\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"observer\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\") \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"=>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"  for\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" mutation\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" of\"}),e(c.span,{style:{color:\"#E06C75\"},children:\" mutationList\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"    if\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"mutation\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"type\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" ===\"}),e(c.span,{style:{color:\"#98C379\"},children:' \"childList\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"      console\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"log\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"A child node has been added or removed.\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"    } \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"else\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" if\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"mutation\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"type\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" ===\"}),e(c.span,{style:{color:\"#98C379\"},children:' \"attributes\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"      console\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"log\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:\"`The \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"${\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"mutation\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"attributeName\"}),e(c.span,{style:{color:\"#C678DD\"},children:\"}\"}),e(c.span,{style:{color:\"#98C379\"},children:\" attribute was modified.`\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"    }\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"};\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Create an observer instance linked to the callback function\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" observer\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" new\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" MutationObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"callback\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Start observing the target node for configured mutations\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"observer\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"observe\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"targetNode\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#E06C75\"},children:\"config\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Later, you can stop observing\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"observer\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"disconnect\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"();\"})]})]})})}),\"\\n\",e(c.h2,{id:\"resizeobserver\",children:e(c.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#resizeobserver\",children:\"ResizeObserver\"})}),\"\\n\",e(c.p,{children:e(c.strong,{children:\"元素可以用 ResizeObserver 监听大小的改变，当 width、height 被修改时会触发回调。\"})}),\"\\n\",e(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:e(c.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"one-dark-pro\",children:n(c.code,{\"data-language\":\"html\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"style\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#61AFEF\"},children:\"  #box\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"    width: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"100\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"px\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"    height: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"100\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"px\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"    background: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"blue\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"style\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"div\"}),e(c.span,{style:{color:\"#D19A66\"},children:\" id\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"=\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"box\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"></\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"div\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"script\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"  const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" box\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" document\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"querySelector\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:\"'#box'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#61AFEF\"},children:\"  setTimeout\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(() \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"=>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"    box\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"style\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"width\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#98C379\"},children:\" '200px'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"  }, \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"2000\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"  const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" resizeObserver\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" new\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" ResizeObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"entries\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" =>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"    console\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"log\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"entries\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\")\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"  })\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"  resizeObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"observe\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"box\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\")\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"script\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"})]})})}),\"\\n\",e(c.h2,{id:\"performanceobserver\",children:e(c.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#performanceobserver\",children:\"PerformanceObserver\"})}),\"\\n\",n(c.p,{children:[e(c.strong,{children:e(c.code,{children:\"PerformanceObserver()\"})}),\" 构造函数使用给定的观察者 \",e(c.code,{children:\"callback\"}),\" 生成一个新的 \",e(c.a,{href:\"https://developer.mozilla.org/zh-CN/docs/Web/API/PerformanceObserver\",children:e(c.code,{children:\"PerformanceObserver\"})}),\" 对象。当通过 \",e(c.a,{href:\"https://developer.mozilla.org/zh-CN/docs/Web/API/PerformanceObserver/observe\",title:\"observe()\",children:e(c.code,{children:\"observe()\"})}),\" 方法注册的 \",e(c.a,{href:\"https://developer.mozilla.org/zh-CN/docs/Web/API/PerformanceEntry/entryType\",title:\"条目类型\",children:\"条目类型\"}),\" 的 \",e(c.a,{href:\"https://developer.mozilla.org/zh-CN/docs/Web/API/PerformanceEntry\",title:\"性能条目事件\",children:\"性能条目事件\"}),\" 被记录下来时，调用该观察者回调。\"]}),\"\\n\",e(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:e(c.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"one-dark-pro\",children:n(c.code,{\"data-language\":\"html\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"html\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"body\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"  <\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"button\"}),e(c.span,{style:{color:\"#D19A66\"},children:\" onclick\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"=\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"'}),e(c.span,{style:{color:\"#61AFEF\"},children:\"measureClick\"}),e(c.span,{style:{color:\"#98C379\"},children:'()\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">Measure</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"button\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"  <\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"img\"}),e(c.span,{style:{color:\"#D19A66\"},children:\" src\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"=\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"https://p9-passport.byteacctimg.com/img/user-avatar/4e9e751e2b32fb8afbbf559a296ccbf2~300x300.image\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" />\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"  <\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"script\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"    const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" performanceObserver\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" new\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" PerformanceObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"list\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" =>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"      list\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"getEntries\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"().\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"forEach\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"entry\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" =>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"        console\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"log\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"entry\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"}),e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// 上报\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"      })\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"    });\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"    performanceObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"observe\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"({\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"entryTypes\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\": [\"}),e(c.span,{style:{color:\"#98C379\"},children:\"'resource'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#98C379\"},children:\"'mark'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#98C379\"},children:\"'measure'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"]});\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"    performance\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"mark\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:\"'registered-observer'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"    function\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" measureClick\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"      performance\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"measure\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:\"'button clicked'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"    }\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"  </\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"script\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"body\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"html\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"})]})})}),\"\\n\",e(c.p,{children:\"创建 PerformanceObserver 对象，监听 mark（时间点）、measure（时间段）、resource（资源加载耗时） 这三种记录时间的行为。\"}),\"\\n\",e(c.p,{children:\"然后我们用 mark 记录了某个时间点，点击 button 的时候用 measure 记录了某个时间段的数据。\"}),\"\\n\",e(c.p,{children:\"当这些记录行为发生的时候，希望能触发回调，在里面可以上报。\"}),\"\\n\",e(c.h2,{id:\"reportingobserver\",children:e(c.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#reportingobserver\",children:\"ReportingObserver\"})}),\"\\n\",e(c.p,{children:\"当浏览器运行到过时（deprecation）的 api 的时候，会在控制台打印一个过时的报告；浏览器还会在一些情况下对网页行为做一些干预（intervention），比如会把占用 cpu 太多的广告的 iframe 删掉。\"}),\"\\n\",e(c.p,{children:\"![[image.png]]\"}),\"\\n\",e(c.p,{children:\"![[image-1.png]]\"}),\"\\n\",e(c.p,{children:\"浏览器提供了 ReportingObserver 的 api 用来监听这些报告的打印，我们可以拿到这些报告然后上传。\"}),\"\\n\",e(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:e(c.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"one-dark-pro\",children:n(c.code,{\"data-language\":\"js\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" options\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E06C75\"},children:\"  types\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\": [\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"deprecation\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"],\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E06C75\"},children:\"  buffered\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\": \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"true\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"};\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" observer\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" new\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" ReportingObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"((\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"reports\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"observer\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\") \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"=>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"  reportBtn\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"onclick\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" () \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"=>\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" displayReports\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"reports\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"}, \"}),e(c.span,{style:{color:\"#E06C75\"},children:\"options\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"observer\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"observe\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"();\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"})]})})}),\"\\n\",e(c.p,{children:\"浏览器提供了这 5 种 Observer：\"}),\"\\n\",n(c.ul,{children:[\"\\n\",e(c.li,{children:\"IntersectionObserver：监听元素可见性变化，常用来做元素显示的数据采集、图片的懒加载\"}),\"\\n\",e(c.li,{children:\"MutationObserver：监听元素属性和子节点变化，比如可以用来做去不掉的水印\"}),\"\\n\",e(c.li,{children:\"ResizeObserver：监听元素大小变化\"}),\"\\n\"]}),\"\\n\",e(c.p,{children:\"还有两个与元素无关的：\"}),\"\\n\",n(c.ul,{children:[\"\\n\",e(c.li,{children:\"PerformanceObserver：监听 performance 记录的行为，来上报数据\"}),\"\\n\",e(c.li,{children:\"ReportingObserver：监听过时的 api、浏览器的一些干预行为的报告，可以让我们更全面的了解网页 app 的运行情况\"}),\"\\n\"]})]})}return{default:function(l={}){const{wrapper:n}=l.components||{};return n?e(n,{...l,children:e(_createMdxContent,{...l})}):_createMdxContent(l)}};","title":"浏览器的 5 种 Observer","description":"介绍了监听网页元素的变化的5种观察者","date":"2025-03-09T00:00:00.000Z","published":true,"body":"const{Fragment:l,jsx:e,jsxs:n}=arguments[0];function _createMdxContent(r){const c={a:\"a\",code:\"code\",figure:\"figure\",h2:\"h2\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...r.components},{Callout:s}=c;return s||function(l,e){throw new Error(\"Expected \"+(e?\"component\":\"object\")+\" `\"+l+\"` to be defined: you likely forgot to import, pass, or provide it.\")}(\"Callout\",!0),n(l,{children:[e(c.p,{children:\"对于一些不是由用户直接触发的事件， 比如元素从不可见到可见、元素大小的改变、元素的属性和子节点的修改等，这类事件如何监听呢？\"}),\"\\n\",e(c.p,{children:\"浏览器提供了 5 种 Observer 来监听这些变动：MutationObserver、IntersectionObserver、PerformanceObserver、ResizeObserver、ReportingObserver。\"}),\"\\n\",e(c.h2,{id:\"intersectionobserver\",children:e(c.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#intersectionobserver\",children:\"IntersectionObserver\"})}),\"\\n\",e(c.p,{children:\"IntersectionObserver：监听一个元素从不可见到可见，从可见到不可见。\"}),\"\\n\",e(s,{type:\"warning\",children:e(c.p,{children:\"IntersectionObserver 可以监听一个元素和可视区域相交部分的比例，然后在可视比例达到某个阈值的时候触发回调。\"})}),\"\\n\",e(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:e(c.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"one-dark-pro\",children:n(c.code,{\"data-language\":\"html\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"style\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#61AFEF\"},children:\"    #box1\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#61AFEF\"},children:\"    #box2\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      width: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"100\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"px\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      height: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"100\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"px\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      background: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"blue\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      color: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"#fff\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      position: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"relative\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"    }\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#61AFEF\"},children:\"    #box1\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      top: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"500\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"px\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"    }\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#61AFEF\"},children:\"    #box2\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"      top: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"800\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"px\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"    }\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"  </\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"style\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"div\"}),e(c.span,{style:{color:\"#D19A66\"},children:\" id\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"=\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"box1\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">BOX111</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"div\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"div\"}),e(c.span,{style:{color:\"#D19A66\"},children:\" id\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"=\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"box2\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">BOX222</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"div\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"script\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"    const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" intersectionObserver\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" new\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" IntersectionObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"((\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"entries\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\") \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"=>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"      entries\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"forEach\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"entry\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" =>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"        console\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"info\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"entry\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"isIntersecting\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\",\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"entry\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"target\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\",\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"entry\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"intersectionRatio\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\")\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"      });\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"    },{\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"threshold\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\":[\"}),e(c.span,{style:{color:\"#D19A66\"},children:\"0.5\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\",\"}),e(c.span,{style:{color:\"#D19A66\"},children:\"1\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"]} \"}),e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// 可见比例为0.5 和1触发回调\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"    const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" box1\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" document\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"getElementById\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:\"'box1'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"    const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" box2\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" document\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"getElementById\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:\"'box2'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"    intersectionObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"observe\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"box1\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"    intersectionObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"observe\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"box2\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"script\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]})]})})}),\"\\n\",e(c.h2,{id:\"mutationobserver\",children:e(c.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#mutationobserver\",children:\"MutationObserver\"})}),\"\\n\",e(c.p,{children:e(c.strong,{children:\"MutationObserver 可以监听对元素的属性的修改、对它的子节点的增删改。\"})}),\"\\n\",e(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:e(c.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"one-dark-pro\",children:n(c.code,{\"data-language\":\"js\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Select the node that will be observed for mutations\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" targetNode\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" document\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"getElementById\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"some-id\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Options for the observer (which mutations to observe)\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" config\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" { \"}),e(c.span,{style:{color:\"#E06C75\"},children:\"attributes\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\": \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"true\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#E06C75\"},children:\"childList\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\": \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"true\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#E06C75\"},children:\"subtree\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\": \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"true\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" };\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Callback function to execute when mutations are observed\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" callback\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"mutationList\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"observer\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\") \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"=>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"  for\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" mutation\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" of\"}),e(c.span,{style:{color:\"#E06C75\"},children:\" mutationList\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"    if\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"mutation\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"type\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" ===\"}),e(c.span,{style:{color:\"#98C379\"},children:' \"childList\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"      console\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"log\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"A child node has been added or removed.\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"    } \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"else\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" if\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"mutation\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"type\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" ===\"}),e(c.span,{style:{color:\"#98C379\"},children:' \"attributes\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"      console\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"log\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:\"`The \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"${\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"mutation\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"attributeName\"}),e(c.span,{style:{color:\"#C678DD\"},children:\"}\"}),e(c.span,{style:{color:\"#98C379\"},children:\" attribute was modified.`\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"    }\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"};\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Create an observer instance linked to the callback function\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" observer\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" new\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" MutationObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"callback\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Start observing the target node for configured mutations\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"observer\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"observe\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"targetNode\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#E06C75\"},children:\"config\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Later, you can stop observing\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"observer\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"disconnect\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"();\"})]})]})})}),\"\\n\",e(c.h2,{id:\"resizeobserver\",children:e(c.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#resizeobserver\",children:\"ResizeObserver\"})}),\"\\n\",e(c.p,{children:e(c.strong,{children:\"元素可以用 ResizeObserver 监听大小的改变，当 width、height 被修改时会触发回调。\"})}),\"\\n\",e(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:e(c.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"one-dark-pro\",children:n(c.code,{\"data-language\":\"html\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"style\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#61AFEF\"},children:\"  #box\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"    width: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"100\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"px\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"    height: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"100\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"px\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"    background: \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"blue\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"style\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"div\"}),e(c.span,{style:{color:\"#D19A66\"},children:\" id\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"=\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"box\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"></\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"div\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"script\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"  const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" box\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" document\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"querySelector\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:\"'#box'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#61AFEF\"},children:\"  setTimeout\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(() \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"=>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"    box\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\"style\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"width\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#98C379\"},children:\" '200px'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"  }, \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"2000\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"  const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" resizeObserver\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" new\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" ResizeObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"entries\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" =>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"    console\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"log\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"entries\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\")\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"  })\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"  resizeObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"observe\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"box\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\")\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"script\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"})]})})}),\"\\n\",e(c.h2,{id:\"performanceobserver\",children:e(c.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#performanceobserver\",children:\"PerformanceObserver\"})}),\"\\n\",n(c.p,{children:[e(c.strong,{children:e(c.code,{children:\"PerformanceObserver()\"})}),\" 构造函数使用给定的观察者 \",e(c.code,{children:\"callback\"}),\" 生成一个新的 \",e(c.a,{href:\"https://developer.mozilla.org/zh-CN/docs/Web/API/PerformanceObserver\",children:e(c.code,{children:\"PerformanceObserver\"})}),\" 对象。当通过 \",e(c.a,{href:\"https://developer.mozilla.org/zh-CN/docs/Web/API/PerformanceObserver/observe\",title:\"observe()\",children:e(c.code,{children:\"observe()\"})}),\" 方法注册的 \",e(c.a,{href:\"https://developer.mozilla.org/zh-CN/docs/Web/API/PerformanceEntry/entryType\",title:\"条目类型\",children:\"条目类型\"}),\" 的 \",e(c.a,{href:\"https://developer.mozilla.org/zh-CN/docs/Web/API/PerformanceEntry\",title:\"性能条目事件\",children:\"性能条目事件\"}),\" 被记录下来时，调用该观察者回调。\"]}),\"\\n\",e(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:e(c.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"one-dark-pro\",children:n(c.code,{\"data-language\":\"html\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"html\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"body\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"  <\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"button\"}),e(c.span,{style:{color:\"#D19A66\"},children:\" onclick\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"=\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"'}),e(c.span,{style:{color:\"#61AFEF\"},children:\"measureClick\"}),e(c.span,{style:{color:\"#98C379\"},children:'()\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">Measure</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"button\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"  <\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"img\"}),e(c.span,{style:{color:\"#D19A66\"},children:\" src\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"=\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"https://p9-passport.byteacctimg.com/img/user-avatar/4e9e751e2b32fb8afbbf559a296ccbf2~300x300.image\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" />\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"  <\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"script\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"    const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" performanceObserver\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" new\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" PerformanceObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"list\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" =>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"      list\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"getEntries\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"().\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"forEach\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"entry\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" =>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"        console\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"log\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"entry\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"}),e(c.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// 上报\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"      })\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"    });\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"    performanceObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"observe\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"({\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"entryTypes\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\": [\"}),e(c.span,{style:{color:\"#98C379\"},children:\"'resource'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#98C379\"},children:\"'mark'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#98C379\"},children:\"'measure'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"]});\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"    performance\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"mark\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:\"'registered-observer'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"    function\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" measureClick\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"      performance\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"measure\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#98C379\"},children:\"'button clicked'\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"    }\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"  </\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"script\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"body\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"</\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"html\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\">\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"})]})})}),\"\\n\",e(c.p,{children:\"创建 PerformanceObserver 对象，监听 mark（时间点）、measure（时间段）、resource（资源加载耗时） 这三种记录时间的行为。\"}),\"\\n\",e(c.p,{children:\"然后我们用 mark 记录了某个时间点，点击 button 的时候用 measure 记录了某个时间段的数据。\"}),\"\\n\",e(c.p,{children:\"当这些记录行为发生的时候，希望能触发回调，在里面可以上报。\"}),\"\\n\",e(c.h2,{id:\"reportingobserver\",children:e(c.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#reportingobserver\",children:\"ReportingObserver\"})}),\"\\n\",e(c.p,{children:\"当浏览器运行到过时（deprecation）的 api 的时候，会在控制台打印一个过时的报告；浏览器还会在一些情况下对网页行为做一些干预（intervention），比如会把占用 cpu 太多的广告的 iframe 删掉。\"}),\"\\n\",e(c.p,{children:\"![[image.png]]\"}),\"\\n\",e(c.p,{children:\"![[image-1.png]]\"}),\"\\n\",e(c.p,{children:\"浏览器提供了 ReportingObserver 的 api 用来监听这些报告的打印，我们可以拿到这些报告然后上传。\"}),\"\\n\",e(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:e(c.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"one-dark-pro\",children:n(c.code,{\"data-language\":\"js\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" options\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E06C75\"},children:\"  types\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\": [\"}),e(c.span,{style:{color:\"#98C379\"},children:'\"deprecation\"'}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"],\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E06C75\"},children:\"  buffered\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\": \"}),e(c.span,{style:{color:\"#D19A66\"},children:\"true\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:e(c.span,{style:{color:\"#ABB2BF\"},children:\"};\"})}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#C678DD\"},children:\"const\"}),e(c.span,{style:{color:\"#E5C07B\"},children:\" observer\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#C678DD\"},children:\" new\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" ReportingObserver\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"((\"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"reports\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\", \"}),e(c.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"observer\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\") \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"=>\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"  reportBtn\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"onclick\"}),e(c.span,{style:{color:\"#56B6C2\"},children:\" =\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\" () \"}),e(c.span,{style:{color:\"#C678DD\"},children:\"=>\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\" displayReports\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),e(c.span,{style:{color:\"#E06C75\"},children:\"reports\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#ABB2BF\"},children:\"}, \"}),e(c.span,{style:{color:\"#E06C75\"},children:\"options\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(c.span,{\"data-line\":\"\",children:[e(c.span,{style:{color:\"#E5C07B\"},children:\"observer\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\".\"}),e(c.span,{style:{color:\"#61AFEF\"},children:\"observe\"}),e(c.span,{style:{color:\"#ABB2BF\"},children:\"();\"})]}),\"\\n\",e(c.span,{\"data-line\":\"\",children:\" \"})]})})}),\"\\n\",e(c.p,{children:\"浏览器提供了这 5 种 Observer：\"}),\"\\n\",n(c.ul,{children:[\"\\n\",e(c.li,{children:\"IntersectionObserver：监听元素可见性变化，常用来做元素显示的数据采集、图片的懒加载\"}),\"\\n\",e(c.li,{children:\"MutationObserver：监听元素属性和子节点变化，比如可以用来做去不掉的水印\"}),\"\\n\",e(c.li,{children:\"ResizeObserver：监听元素大小变化\"}),\"\\n\"]}),\"\\n\",e(c.p,{children:\"还有两个与元素无关的：\"}),\"\\n\",n(c.ul,{children:[\"\\n\",e(c.li,{children:\"PerformanceObserver：监听 performance 记录的行为，来上报数据\"}),\"\\n\",e(c.li,{children:\"ReportingObserver：监听过时的 api、浏览器的一些干预行为的报告，可以让我们更全面的了解网页 app 的运行情况\"}),\"\\n\"]})]})}return{default:function(l={}){const{wrapper:n}=l.components||{};return n?e(n,{...l,children:e(_createMdxContent,{...l})}):_createMdxContent(l)}};","slugAsParams":"hello"},{"slug":"blog/JS_GC","code":"const{Fragment:e,jsx:n,jsxs:a}=arguments[0];function _createMdxContent(r){const l={a:\"a\",code:\"code\",em:\"em\",figure:\"figure\",h2:\"h2\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...r.components};return a(e,{children:[n(l.p,{children:\"Memory management in JavaScript is performed automatically and invisibly to us. We create primitives, objects, functions… All that takes memory.\"}),\"\\n\",n(l.p,{children:\"What happens when something is not needed any more? How does the JavaScript engine discover it and clean it up?\"}),\"\\n\",n(l.h2,{id:\"reachability\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#reachability\",children:n(l.a,{href:\"#reachability\",children:\"Reachability\"})})}),\"\\n\",a(l.p,{children:[\"The main concept of memory management in JavaScript is \",n(l.em,{children:\"reachability\"}),\".\"]}),\"\\n\",n(l.p,{children:\"Simply put, “reachable” values are those that are accessible or usable somehow. They are guaranteed to be stored in memory.\"}),\"\\n\",a(l.ol,{children:[\"\\n\",a(l.li,{children:[\"\\n\",n(l.p,{children:\"There’s a base set of inherently reachable values, that cannot be deleted for obvious reasons.\"}),\"\\n\",n(l.p,{children:\"For instance:\"}),\"\\n\",a(l.ul,{children:[\"\\n\",n(l.li,{children:\"The currently executing function, its local variables and parameters.\"}),\"\\n\",n(l.li,{children:\"Other functions on the current chain of nested calls, their local variables and parameters.\"}),\"\\n\",n(l.li,{children:\"Global variables.\"}),\"\\n\",n(l.li,{children:\"(there are some other, internal ones as well)\"}),\"\\n\"]}),\"\\n\",a(l.p,{children:[\"These values are called \",n(l.em,{children:\"roots\"}),\".\"]}),\"\\n\"]}),\"\\n\",a(l.li,{children:[\"\\n\",n(l.p,{children:\"Any other value is considered reachable if it’s reachable from a root by a reference or by a chain of references.\"}),\"\\n\",a(l.p,{children:[\"For instance, if there’s an object in a global variable, and that object has a property referencing another object, \",n(l.em,{children:\"that\"}),\" object is considered reachable. And those that it references are also reachable. Detailed examples to follow.\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",a(l.p,{children:[\"There’s a background process in the JavaScript engine that is called \",n(l.a,{href:\"https://en.wikipedia.org/wiki/Garbage_collection_(computer_science)\",children:\"garbage collector\"}),\". It monitors all objects and removes those that have become unreachable.\"]}),\"\\n\",n(l.h2,{id:\"a-simple-example\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#a-simple-example\",children:n(l.a,{href:\"#a-simple-example\",children:\"A simple example\"})})}),\"\\n\",n(l.p,{children:\"Here’s the simplest example:\"}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:a(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// user has a reference to the object\"})}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" user\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"  name\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\": \"}),n(l.span,{style:{color:\"#98C379\"},children:'\"John\"'})]}),\"\\n\",n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#ABB2BF\"},children:\"};\"})})]})})}),\"\\n\",a(l.p,{children:[\"Here the arrow depicts an object reference. The global variable \",n(l.code,{children:'\"user\"'}),\" references the object \",n(l.code,{children:'{name: \"John\"}'}),\" (we’ll call it John for brevity). The \",n(l.code,{children:'\"name\"'}),\" property of John stores a primitive, so it’s painted inside the object.\"]}),\"\\n\",a(l.p,{children:[\"If the value of \",n(l.code,{children:\"user\"}),\" is overwritten, the reference is lost:\"]}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:n(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"user\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#D19A66\"},children:\" null\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]})})})}),\"\\n\",n(l.p,{children:\"Now John becomes unreachable. There’s no way to access it, no references to it. Garbage collector will junk the data and free the memory.\"}),\"\\n\",n(l.h2,{id:\"two-references\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#two-references\",children:n(l.a,{href:\"#two-references\",children:\"Two references\"})})}),\"\\n\",a(l.p,{children:[\"Now let’s imagine we copied the reference from \",n(l.code,{children:\"user\"}),\" to \",n(l.code,{children:\"admin\"}),\":\"]}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:a(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// user has a reference to the object\"})}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" user\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"  name\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\": \"}),n(l.span,{style:{color:\"#98C379\"},children:'\"John\"'})]}),\"\\n\",n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#ABB2BF\"},children:\"};\"})}),\"\\n\",n(l.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" admin\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" user\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]})]})})}),\"\\n\",n(l.p,{children:\"Now if we do the same:\"}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:n(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"user\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#D19A66\"},children:\" null\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]})})})}),\"\\n\",a(l.p,{children:[\"…Then the object is still reachable via \",n(l.code,{children:\"admin\"}),\" global variable, so it must stay in memory. If we overwrite \",n(l.code,{children:\"admin\"}),\" too, then it can be removed.\"]}),\"\\n\",n(l.h2,{id:\"interlinked-objects\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#interlinked-objects\",children:n(l.a,{href:\"#interlinked-objects\",children:\"Interlinked objects\"})})}),\"\\n\",n(l.p,{children:\"Now a more complex example. The family:\"}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:a(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"function\"}),n(l.span,{style:{color:\"#61AFEF\"},children:\" marry\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(l.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"man\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\", \"}),n(l.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"woman\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E5C07B\"},children:\"  woman\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(l.span,{style:{color:\"#E06C75\"},children:\"husband\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" man\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E5C07B\"},children:\"  man\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(l.span,{style:{color:\"#E06C75\"},children:\"wife\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" woman\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(l.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"  return\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"    father\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\": \"}),n(l.span,{style:{color:\"#E06C75\"},children:\"man\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"    mother\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\": \"}),n(l.span,{style:{color:\"#E06C75\"},children:\"woman\"})]}),\"\\n\",n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(l.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" family\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#61AFEF\"},children:\" marry\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\"({\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"  name\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\": \"}),n(l.span,{style:{color:\"#98C379\"},children:'\"John\"'})]}),\"\\n\",n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#ABB2BF\"},children:\"}, {\"})}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"  name\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\": \"}),n(l.span,{style:{color:\"#98C379\"},children:'\"Ann\"'})]}),\"\\n\",n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#ABB2BF\"},children:\"});\"})})]})})}),\"\\n\",a(l.p,{children:[\"Function \",n(l.code,{children:\"marry\"}),\" “marries” two objects by giving them references to each other and returns a new object that contains them both.\"]}),\"\\n\",n(l.p,{children:\"The resulting memory structure:\"}),\"\\n\",n(l.p,{children:\"As of now, all objects are reachable.\"}),\"\\n\",n(l.p,{children:\"Now let’s remove two references:\"}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:a(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"delete\"}),n(l.span,{style:{color:\"#E5C07B\"},children:\" family\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(l.span,{style:{color:\"#E06C75\"},children:\"father\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"delete\"}),n(l.span,{style:{color:\"#E5C07B\"},children:\" family\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(l.span,{style:{color:\"#E5C07B\"},children:\"mother\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(l.span,{style:{color:\"#E06C75\"},children:\"husband\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]})]})})}),\"\\n\",n(l.p,{children:\"It’s not enough to delete only one of these two references, because all objects would still be reachable.\"}),\"\\n\",n(l.p,{children:\"But if we delete both, then we can see that John has no incoming reference any more:\"}),\"\\n\",n(l.p,{children:\"Outgoing references do not matter. Only incoming ones can make an object reachable. So, John is now unreachable and will be removed from the memory with all its data that also became unaccessible.\"}),\"\\n\",n(l.p,{children:\"After garbage collection:\"}),\"\\n\",n(l.h2,{id:\"unreachable-island\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#unreachable-island\",children:n(l.a,{href:\"#unreachable-island\",children:\"Unreachable island\"})})}),\"\\n\",n(l.p,{children:\"It is possible that the whole island of interlinked objects becomes unreachable and is removed from the memory.\"}),\"\\n\",n(l.p,{children:\"The source object is the same as above. Then:\"}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:n(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"family\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#D19A66\"},children:\" null\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]})})})}),\"\\n\",n(l.p,{children:\"The in-memory picture becomes:\"}),\"\\n\",n(l.p,{children:\"This example demonstrates how important the concept of reachability is.\"}),\"\\n\",n(l.p,{children:\"It’s obvious that John and Ann are still linked, both have incoming references. But that’s not enough.\"}),\"\\n\",a(l.p,{children:[\"The former \",n(l.code,{children:'\"family\"'}),\" object has been unlinked from the root, there’s no reference to it any more, so the whole island becomes unreachable and will be removed.\"]}),\"\\n\",n(l.h2,{id:\"internal-algorithms\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#internal-algorithms\",children:n(l.a,{href:\"#internal-algorithms\",children:\"Internal algorithms\"})})}),\"\\n\",n(l.p,{children:\"The basic garbage collection algorithm is called “mark-and-sweep”.\"}),\"\\n\",n(l.p,{children:\"The following “garbage collection” steps are regularly performed:\"}),\"\\n\",a(l.ul,{children:[\"\\n\",n(l.li,{children:\"The garbage collector takes roots and “marks” (remembers) them.\"}),\"\\n\",n(l.li,{children:\"Then it visits and “marks” all references from them.\"}),\"\\n\",a(l.li,{children:[\"Then it visits marked objects and marks \",n(l.em,{children:\"their\"}),\" references. All visited objects are remembered, so as not to visit the same object twice in the future.\"]}),\"\\n\",n(l.li,{children:\"…And so on until every reachable (from the roots) references are visited.\"}),\"\\n\",n(l.li,{children:\"All objects except marked ones are removed.\"}),\"\\n\"]}),\"\\n\",n(l.p,{children:\"For instance, let our object structure look like this:\"}),\"\\n\",n(l.p,{children:\"We can clearly see an “unreachable island” to the right side. Now let’s see how “mark-and-sweep” garbage collector deals with it.\"}),\"\\n\",n(l.p,{children:\"The first step marks the roots:\"}),\"\\n\",n(l.p,{children:\"Then we follow their references and mark referenced objects:\"}),\"\\n\",n(l.p,{children:\"…And continue to follow further references, while possible:\"}),\"\\n\",n(l.p,{children:\"Now the objects that could not be visited in the process are considered unreachable and will be removed:\"}),\"\\n\",n(l.p,{children:\"We can also imagine the process as spilling a huge bucket of paint from the roots, that flows through all references and marks all reachable objects. The unmarked ones are then removed.\"}),\"\\n\",n(l.p,{children:\"That’s the concept of how garbage collection works. JavaScript engines apply many optimizations to make it run faster and not introduce any delays into the code execution.\"}),\"\\n\",n(l.p,{children:\"Some of the optimizations:\"}),\"\\n\",a(l.ul,{children:[\"\\n\",a(l.li,{children:[n(l.strong,{children:\"Generational collection\"}),\" – objects are split into two sets: “new ones” and “old ones”. In typical code, many objects have a short life span: they appear, do their job and die fast, so it makes sense to track new objects and clear the memory from them if that’s the case. Those that survive for long enough, become “old” and are examined less often.\"]}),\"\\n\",a(l.li,{children:[n(l.strong,{children:\"Incremental collection\"}),\" – if there are many objects, and we try to walk and mark the whole object set at once, it may take some time and introduce visible delays in the execution. So the engine splits the whole set of existing objects into multiple parts. And then clear these parts one after another. There are many small garbage collections instead of a total one. That requires some extra bookkeeping between them to track changes, but we get many tiny delays instead of a big one.\"]}),\"\\n\",a(l.li,{children:[n(l.strong,{children:\"Idle-time collection\"}),\" – the garbage collector tries to run only while the CPU is idle, to reduce the possible effect on the execution.\"]}),\"\\n\"]}),\"\\n\",n(l.p,{children:\"There exist other optimizations and flavours of garbage collection algorithms. As much as I’d like to describe them here, I have to hold off, because different engines implement different tweaks and techniques. And, what’s even more important, things change as engines develop, so studying deeper “in advance”, without a real need is probably not worth that. Unless, of course, it is a matter of pure interest, then there will be some links for you below.\"}),\"\\n\",n(l.h2,{id:\"summary\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#summary\",children:n(l.a,{href:\"#summary\",children:\"Summary\"})})}),\"\\n\",n(l.p,{children:\"The main things to know:\"}),\"\\n\",a(l.ul,{children:[\"\\n\",n(l.li,{children:\"Garbage collection is performed automatically. We cannot force or prevent it.\"}),\"\\n\",n(l.li,{children:\"Objects are retained in memory while they are reachable.\"}),\"\\n\",n(l.li,{children:\"Being referenced is not the same as being reachable (from a root): a pack of interlinked objects can become unreachable as a whole, as we’ve seen in the example above.\"}),\"\\n\"]}),\"\\n\",n(l.p,{children:\"Modern engines implement advanced algorithms of garbage collection.\"}),\"\\n\",n(l.p,{children:\"A general book “The Garbage Collection Handbook: The Art of Automatic Memory Management” (R. Jones et al) covers some of them.\"}),\"\\n\",a(l.p,{children:[\"If you are familiar with low-level programming, more detailed information about V8’s garbage collector is in the article \",n(l.a,{href:\"https://jayconrod.com/posts/55/a-tour-of-v8-garbage-collection\",children:\"A tour of V8: Garbage Collection\"}),\".\"]}),\"\\n\",a(l.p,{children:[\"The \",n(l.a,{href:\"https://v8.dev/\",children:\"V8 blog\"}),\" also publishes articles about changes in memory management from time to time. Naturally, to learn more about garbage collection, you’d better prepare by learning about V8 internals in general and read the blog of \",n(l.a,{href:\"https://mrale.ph/\",children:\"Vyacheslav Egorov\"}),\" who worked as one of the V8 engineers. I’m saying: “V8”, because it is best covered by articles on the internet. For other engines, many approaches are similar, but garbage collection differs in many aspects.\"]}),\"\\n\",n(l.p,{children:\"In-depth knowledge of engines is good when you need low-level optimizations. It would be wise to plan that as the next step after you’re familiar with the language.\"})]})}return{default:function(e={}){const{wrapper:a}=e.components||{};return a?n(a,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};","title":"Garbage collection","description":"复制自javascript.info","date":"2025-03-30T00:00:00.000Z","published":true,"body":"const{Fragment:e,jsx:n,jsxs:a}=arguments[0];function _createMdxContent(r){const l={a:\"a\",code:\"code\",em:\"em\",figure:\"figure\",h2:\"h2\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...r.components};return a(e,{children:[n(l.p,{children:\"Memory management in JavaScript is performed automatically and invisibly to us. We create primitives, objects, functions… All that takes memory.\"}),\"\\n\",n(l.p,{children:\"What happens when something is not needed any more? How does the JavaScript engine discover it and clean it up?\"}),\"\\n\",n(l.h2,{id:\"reachability\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#reachability\",children:n(l.a,{href:\"#reachability\",children:\"Reachability\"})})}),\"\\n\",a(l.p,{children:[\"The main concept of memory management in JavaScript is \",n(l.em,{children:\"reachability\"}),\".\"]}),\"\\n\",n(l.p,{children:\"Simply put, “reachable” values are those that are accessible or usable somehow. They are guaranteed to be stored in memory.\"}),\"\\n\",a(l.ol,{children:[\"\\n\",a(l.li,{children:[\"\\n\",n(l.p,{children:\"There’s a base set of inherently reachable values, that cannot be deleted for obvious reasons.\"}),\"\\n\",n(l.p,{children:\"For instance:\"}),\"\\n\",a(l.ul,{children:[\"\\n\",n(l.li,{children:\"The currently executing function, its local variables and parameters.\"}),\"\\n\",n(l.li,{children:\"Other functions on the current chain of nested calls, their local variables and parameters.\"}),\"\\n\",n(l.li,{children:\"Global variables.\"}),\"\\n\",n(l.li,{children:\"(there are some other, internal ones as well)\"}),\"\\n\"]}),\"\\n\",a(l.p,{children:[\"These values are called \",n(l.em,{children:\"roots\"}),\".\"]}),\"\\n\"]}),\"\\n\",a(l.li,{children:[\"\\n\",n(l.p,{children:\"Any other value is considered reachable if it’s reachable from a root by a reference or by a chain of references.\"}),\"\\n\",a(l.p,{children:[\"For instance, if there’s an object in a global variable, and that object has a property referencing another object, \",n(l.em,{children:\"that\"}),\" object is considered reachable. And those that it references are also reachable. Detailed examples to follow.\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",a(l.p,{children:[\"There’s a background process in the JavaScript engine that is called \",n(l.a,{href:\"https://en.wikipedia.org/wiki/Garbage_collection_(computer_science)\",children:\"garbage collector\"}),\". It monitors all objects and removes those that have become unreachable.\"]}),\"\\n\",n(l.h2,{id:\"a-simple-example\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#a-simple-example\",children:n(l.a,{href:\"#a-simple-example\",children:\"A simple example\"})})}),\"\\n\",n(l.p,{children:\"Here’s the simplest example:\"}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:a(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// user has a reference to the object\"})}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" user\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"  name\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\": \"}),n(l.span,{style:{color:\"#98C379\"},children:'\"John\"'})]}),\"\\n\",n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#ABB2BF\"},children:\"};\"})})]})})}),\"\\n\",a(l.p,{children:[\"Here the arrow depicts an object reference. The global variable \",n(l.code,{children:'\"user\"'}),\" references the object \",n(l.code,{children:'{name: \"John\"}'}),\" (we’ll call it John for brevity). The \",n(l.code,{children:'\"name\"'}),\" property of John stores a primitive, so it’s painted inside the object.\"]}),\"\\n\",a(l.p,{children:[\"If the value of \",n(l.code,{children:\"user\"}),\" is overwritten, the reference is lost:\"]}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:n(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"user\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#D19A66\"},children:\" null\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]})})})}),\"\\n\",n(l.p,{children:\"Now John becomes unreachable. There’s no way to access it, no references to it. Garbage collector will junk the data and free the memory.\"}),\"\\n\",n(l.h2,{id:\"two-references\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#two-references\",children:n(l.a,{href:\"#two-references\",children:\"Two references\"})})}),\"\\n\",a(l.p,{children:[\"Now let’s imagine we copied the reference from \",n(l.code,{children:\"user\"}),\" to \",n(l.code,{children:\"admin\"}),\":\"]}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:a(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// user has a reference to the object\"})}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" user\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"  name\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\": \"}),n(l.span,{style:{color:\"#98C379\"},children:'\"John\"'})]}),\"\\n\",n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#ABB2BF\"},children:\"};\"})}),\"\\n\",n(l.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" admin\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" user\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]})]})})}),\"\\n\",n(l.p,{children:\"Now if we do the same:\"}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:n(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"user\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#D19A66\"},children:\" null\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]})})})}),\"\\n\",a(l.p,{children:[\"…Then the object is still reachable via \",n(l.code,{children:\"admin\"}),\" global variable, so it must stay in memory. If we overwrite \",n(l.code,{children:\"admin\"}),\" too, then it can be removed.\"]}),\"\\n\",n(l.h2,{id:\"interlinked-objects\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#interlinked-objects\",children:n(l.a,{href:\"#interlinked-objects\",children:\"Interlinked objects\"})})}),\"\\n\",n(l.p,{children:\"Now a more complex example. The family:\"}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:a(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"function\"}),n(l.span,{style:{color:\"#61AFEF\"},children:\" marry\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(l.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"man\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\", \"}),n(l.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"woman\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E5C07B\"},children:\"  woman\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(l.span,{style:{color:\"#E06C75\"},children:\"husband\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" man\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E5C07B\"},children:\"  man\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(l.span,{style:{color:\"#E06C75\"},children:\"wife\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" woman\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(l.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"  return\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"    father\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\": \"}),n(l.span,{style:{color:\"#E06C75\"},children:\"man\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"    mother\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\": \"}),n(l.span,{style:{color:\"#E06C75\"},children:\"woman\"})]}),\"\\n\",n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(l.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(l.span,{style:{color:\"#E06C75\"},children:\" family\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#61AFEF\"},children:\" marry\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\"({\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"  name\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\": \"}),n(l.span,{style:{color:\"#98C379\"},children:'\"John\"'})]}),\"\\n\",n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#ABB2BF\"},children:\"}, {\"})}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"  name\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\": \"}),n(l.span,{style:{color:\"#98C379\"},children:'\"Ann\"'})]}),\"\\n\",n(l.span,{\"data-line\":\"\",children:n(l.span,{style:{color:\"#ABB2BF\"},children:\"});\"})})]})})}),\"\\n\",a(l.p,{children:[\"Function \",n(l.code,{children:\"marry\"}),\" “marries” two objects by giving them references to each other and returns a new object that contains them both.\"]}),\"\\n\",n(l.p,{children:\"The resulting memory structure:\"}),\"\\n\",n(l.p,{children:\"As of now, all objects are reachable.\"}),\"\\n\",n(l.p,{children:\"Now let’s remove two references:\"}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:a(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"delete\"}),n(l.span,{style:{color:\"#E5C07B\"},children:\" family\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(l.span,{style:{color:\"#E06C75\"},children:\"father\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#C678DD\"},children:\"delete\"}),n(l.span,{style:{color:\"#E5C07B\"},children:\" family\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(l.span,{style:{color:\"#E5C07B\"},children:\"mother\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(l.span,{style:{color:\"#E06C75\"},children:\"husband\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]})]})})}),\"\\n\",n(l.p,{children:\"It’s not enough to delete only one of these two references, because all objects would still be reachable.\"}),\"\\n\",n(l.p,{children:\"But if we delete both, then we can see that John has no incoming reference any more:\"}),\"\\n\",n(l.p,{children:\"Outgoing references do not matter. Only incoming ones can make an object reachable. So, John is now unreachable and will be removed from the memory with all its data that also became unaccessible.\"}),\"\\n\",n(l.p,{children:\"After garbage collection:\"}),\"\\n\",n(l.h2,{id:\"unreachable-island\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#unreachable-island\",children:n(l.a,{href:\"#unreachable-island\",children:\"Unreachable island\"})})}),\"\\n\",n(l.p,{children:\"It is possible that the whole island of interlinked objects becomes unreachable and is removed from the memory.\"}),\"\\n\",n(l.p,{children:\"The source object is the same as above. Then:\"}),\"\\n\",n(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(l.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:n(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:a(l.span,{\"data-line\":\"\",children:[n(l.span,{style:{color:\"#E06C75\"},children:\"family\"}),n(l.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(l.span,{style:{color:\"#D19A66\"},children:\" null\"}),n(l.span,{style:{color:\"#ABB2BF\"},children:\";\"})]})})})}),\"\\n\",n(l.p,{children:\"The in-memory picture becomes:\"}),\"\\n\",n(l.p,{children:\"This example demonstrates how important the concept of reachability is.\"}),\"\\n\",n(l.p,{children:\"It’s obvious that John and Ann are still linked, both have incoming references. But that’s not enough.\"}),\"\\n\",a(l.p,{children:[\"The former \",n(l.code,{children:'\"family\"'}),\" object has been unlinked from the root, there’s no reference to it any more, so the whole island becomes unreachable and will be removed.\"]}),\"\\n\",n(l.h2,{id:\"internal-algorithms\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#internal-algorithms\",children:n(l.a,{href:\"#internal-algorithms\",children:\"Internal algorithms\"})})}),\"\\n\",n(l.p,{children:\"The basic garbage collection algorithm is called “mark-and-sweep”.\"}),\"\\n\",n(l.p,{children:\"The following “garbage collection” steps are regularly performed:\"}),\"\\n\",a(l.ul,{children:[\"\\n\",n(l.li,{children:\"The garbage collector takes roots and “marks” (remembers) them.\"}),\"\\n\",n(l.li,{children:\"Then it visits and “marks” all references from them.\"}),\"\\n\",a(l.li,{children:[\"Then it visits marked objects and marks \",n(l.em,{children:\"their\"}),\" references. All visited objects are remembered, so as not to visit the same object twice in the future.\"]}),\"\\n\",n(l.li,{children:\"…And so on until every reachable (from the roots) references are visited.\"}),\"\\n\",n(l.li,{children:\"All objects except marked ones are removed.\"}),\"\\n\"]}),\"\\n\",n(l.p,{children:\"For instance, let our object structure look like this:\"}),\"\\n\",n(l.p,{children:\"We can clearly see an “unreachable island” to the right side. Now let’s see how “mark-and-sweep” garbage collector deals with it.\"}),\"\\n\",n(l.p,{children:\"The first step marks the roots:\"}),\"\\n\",n(l.p,{children:\"Then we follow their references and mark referenced objects:\"}),\"\\n\",n(l.p,{children:\"…And continue to follow further references, while possible:\"}),\"\\n\",n(l.p,{children:\"Now the objects that could not be visited in the process are considered unreachable and will be removed:\"}),\"\\n\",n(l.p,{children:\"We can also imagine the process as spilling a huge bucket of paint from the roots, that flows through all references and marks all reachable objects. The unmarked ones are then removed.\"}),\"\\n\",n(l.p,{children:\"That’s the concept of how garbage collection works. JavaScript engines apply many optimizations to make it run faster and not introduce any delays into the code execution.\"}),\"\\n\",n(l.p,{children:\"Some of the optimizations:\"}),\"\\n\",a(l.ul,{children:[\"\\n\",a(l.li,{children:[n(l.strong,{children:\"Generational collection\"}),\" – objects are split into two sets: “new ones” and “old ones”. In typical code, many objects have a short life span: they appear, do their job and die fast, so it makes sense to track new objects and clear the memory from them if that’s the case. Those that survive for long enough, become “old” and are examined less often.\"]}),\"\\n\",a(l.li,{children:[n(l.strong,{children:\"Incremental collection\"}),\" – if there are many objects, and we try to walk and mark the whole object set at once, it may take some time and introduce visible delays in the execution. So the engine splits the whole set of existing objects into multiple parts. And then clear these parts one after another. There are many small garbage collections instead of a total one. That requires some extra bookkeeping between them to track changes, but we get many tiny delays instead of a big one.\"]}),\"\\n\",a(l.li,{children:[n(l.strong,{children:\"Idle-time collection\"}),\" – the garbage collector tries to run only while the CPU is idle, to reduce the possible effect on the execution.\"]}),\"\\n\"]}),\"\\n\",n(l.p,{children:\"There exist other optimizations and flavours of garbage collection algorithms. As much as I’d like to describe them here, I have to hold off, because different engines implement different tweaks and techniques. And, what’s even more important, things change as engines develop, so studying deeper “in advance”, without a real need is probably not worth that. Unless, of course, it is a matter of pure interest, then there will be some links for you below.\"}),\"\\n\",n(l.h2,{id:\"summary\",children:n(l.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#summary\",children:n(l.a,{href:\"#summary\",children:\"Summary\"})})}),\"\\n\",n(l.p,{children:\"The main things to know:\"}),\"\\n\",a(l.ul,{children:[\"\\n\",n(l.li,{children:\"Garbage collection is performed automatically. We cannot force or prevent it.\"}),\"\\n\",n(l.li,{children:\"Objects are retained in memory while they are reachable.\"}),\"\\n\",n(l.li,{children:\"Being referenced is not the same as being reachable (from a root): a pack of interlinked objects can become unreachable as a whole, as we’ve seen in the example above.\"}),\"\\n\"]}),\"\\n\",n(l.p,{children:\"Modern engines implement advanced algorithms of garbage collection.\"}),\"\\n\",n(l.p,{children:\"A general book “The Garbage Collection Handbook: The Art of Automatic Memory Management” (R. Jones et al) covers some of them.\"}),\"\\n\",a(l.p,{children:[\"If you are familiar with low-level programming, more detailed information about V8’s garbage collector is in the article \",n(l.a,{href:\"https://jayconrod.com/posts/55/a-tour-of-v8-garbage-collection\",children:\"A tour of V8: Garbage Collection\"}),\".\"]}),\"\\n\",a(l.p,{children:[\"The \",n(l.a,{href:\"https://v8.dev/\",children:\"V8 blog\"}),\" also publishes articles about changes in memory management from time to time. Naturally, to learn more about garbage collection, you’d better prepare by learning about V8 internals in general and read the blog of \",n(l.a,{href:\"https://mrale.ph/\",children:\"Vyacheslav Egorov\"}),\" who worked as one of the V8 engineers. I’m saying: “V8”, because it is best covered by articles on the internet. For other engines, many approaches are similar, but garbage collection differs in many aspects.\"]}),\"\\n\",n(l.p,{children:\"In-depth knowledge of engines is good when you need low-level optimizations. It would be wise to plan that as the next step after you’re familiar with the language.\"})]})}return{default:function(e={}){const{wrapper:a}=e.components||{};return a?n(a,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};","slugAsParams":"JS_GC"},{"slug":"blog/private-protected-properties-methods","code":"const{Fragment:e,jsx:n,jsxs:l}=arguments[0];function _createMdxContent(r){const a={a:\"a\",code:\"code\",em:\"em\",figure:\"figure\",h2:\"h2\",img:\"img\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...r.components};return l(e,{children:[n(a.p,{children:\"One of the most important principles of object oriented programming – delimiting internal interface from the external one.\"}),\"\\n\",n(a.p,{children:\"That is “a must” practice in developing anything more complex than a “hello world” app.\"}),\"\\n\",n(a.p,{children:\"To understand this, let’s break away from development and turn our eyes into the real world.\"}),\"\\n\",n(a.p,{children:\"Usually, devices that we’re using are quite complex. But delimiting the internal interface from the external one allows to use them without problems.\"}),\"\\n\",n(a.h2,{id:\"a-real-life-example\",children:n(a.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#a-real-life-example\",children:n(a.a,{href:\"#a-real-life-example\",children:\"A real-life example\"})})}),\"\\n\",n(a.p,{children:\"For instance, a coffee machine. Simple from outside: a button, a display, a few holes…And, surely, the result – great coffee! :)\"}),\"\\n\",n(a.p,{children:\"But inside… (a picture from the repair manual)\"}),\"\\n\",n(a.p,{children:n(a.img,{src:\"https://javascript.info/article/private-protected-properties-methods/coffee-inside.jpg\",alt:\"img\"})}),\"\\n\",n(a.p,{children:\"A lot of details. But we can use it without knowing anything.\"}),\"\\n\",n(a.p,{children:\"Coffee machines are quite reliable, aren’t they? We can use one for years, and only if something goes wrong – bring it for repairs.\"}),\"\\n\",l(a.p,{children:[\"The secret of reliability and simplicity of a coffee machine – all details are well-tuned and \",n(a.em,{children:\"hidden\"}),\" inside.\"]}),\"\\n\",n(a.p,{children:\"If we remove the protective cover from the coffee machine, then using it will be much more complex (where to press?), and dangerous (it can electrocute).\"}),\"\\n\",n(a.p,{children:\"As we’ll see, in programming objects are like coffee machines.\"}),\"\\n\",n(a.p,{children:\"But in order to hide inner details, we’ll use not a protective cover, but rather special syntax of the language and conventions.\"}),\"\\n\",n(a.h2,{id:\"internal-and-external-interface\",children:n(a.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#internal-and-external-interface\",children:n(a.a,{href:\"#internal-and-external-interface\",children:\"Internal and external interface\"})})}),\"\\n\",n(a.p,{children:\"In object-oriented programming, properties and methods are split into two groups:\"}),\"\\n\",l(a.ul,{children:[\"\\n\",l(a.li,{children:[n(a.em,{children:\"Internal interface\"}),\" – methods and properties, accessible from other methods of the class, but not from the outside.\"]}),\"\\n\",l(a.li,{children:[n(a.em,{children:\"External interface\"}),\" – methods and properties, accessible also from outside the class.\"]}),\"\\n\"]}),\"\\n\",n(a.p,{children:\"If we continue the analogy with the coffee machine – what’s hidden inside: a boiler tube, heating element, and so on – is its internal interface.\"}),\"\\n\",n(a.p,{children:\"An internal interface is used for the object to work, its details use each other. For instance, a boiler tube is attached to the heating element.\"}),\"\\n\",n(a.p,{children:\"But from the outside a coffee machine is closed by the protective cover, so that no one can reach those. Details are hidden and inaccessible. We can use its features via the external interface.\"}),\"\\n\",n(a.p,{children:\"So, all we need to use an object is to know its external interface. We may be completely unaware how it works inside, and that’s great.\"}),\"\\n\",n(a.p,{children:\"That was a general introduction.\"}),\"\\n\",n(a.p,{children:\"In JavaScript, there are two types of object fields (properties and methods):\"}),\"\\n\",l(a.ul,{children:[\"\\n\",n(a.li,{children:\"Public: accessible from anywhere. They comprise the external interface. Until now we were only using public properties and methods.\"}),\"\\n\",n(a.li,{children:\"Private: accessible only from inside the class. These are for the internal interface.\"}),\"\\n\"]}),\"\\n\",n(a.p,{children:\"In many other languages there also exist “protected” fields: accessible only from inside the class and those extending it (like private, but plus access from inheriting classes). They are also useful for the internal interface. They are in a sense more widespread than private ones, because we usually want inheriting classes to gain access to them.\"}),\"\\n\",n(a.p,{children:\"Protected fields are not implemented in JavaScript on the language level, but in practice they are very convenient, so they are emulated.\"}),\"\\n\",n(a.p,{children:\"Now we’ll make a coffee machine in JavaScript with all these types of properties. A coffee machine has a lot of details, we won’t model them to stay simple (though we could).\"}),\"\\n\",n(a.h2,{id:\"protecting-wateramount\",children:n(a.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#protecting-wateramount\",children:n(a.a,{href:\"#protecting-wateramount\",children:\"Protecting “waterAmount”\"})})}),\"\\n\",n(a.p,{children:\"Let’s make a simple coffee machine class first:\"}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E06C75\"},children:\"  waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"; \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// the amount of water inside\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  constructor\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"power\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"    alert\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"( \"}),n(a.span,{style:{color:\"#98C379\"},children:\"`Created a coffee-machine, power: \"}),n(a.span,{style:{color:\"#C678DD\"},children:\"${\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"power\"}),n(a.span,{style:{color:\"#C678DD\"},children:\"}\"}),n(a.span,{style:{color:\"#98C379\"},children:\"`\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" );\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// create the coffee machine\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" coffeeMachine\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#C678DD\"},children:\" new\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#D19A66\"},children:\"100\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// add water\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"coffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 200\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]})]})})}),\"\\n\",l(a.p,{children:[\"Right now the properties \",n(a.code,{children:\"waterAmount\"}),\" and \",n(a.code,{children:\"power\"}),\" are public. We can easily get/set them from the outside to any value.\"]}),\"\\n\",l(a.p,{children:[\"Let’s change \",n(a.code,{children:\"waterAmount\"}),\" property to protected to have more control over it. For instance, we don’t want anyone to set it below zero.\"]}),\"\\n\",n(a.p,{children:l(a.strong,{children:[\"Protected properties are usually prefixed with an underscore \",n(a.code,{children:\"_\"}),\".\"]})}),\"\\n\",n(a.p,{children:\"That is not enforced on the language level, but there’s a well-known convention between programmers that such properties and methods should not be accessed from the outside.\"}),\"\\n\",l(a.p,{children:[\"So our property will be called \",n(a.code,{children:\"_waterAmount\"}),\":\"]}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E06C75\"},children:\"  _waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  set\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    if\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" <\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E06C75\"},children:\"      value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"    }\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  get\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    return\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  constructor\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_power\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// create the coffee machine\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" coffeeMachine\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#C678DD\"},children:\" new\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#D19A66\"},children:\"100\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// add water\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"coffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" -\"}),n(a.span,{style:{color:\"#D19A66\"},children:\"10\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"; \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// _waterAmount will become 0, not -10\"})]})]})})}),\"\\n\",n(a.p,{children:\"Now the access is under control, so setting the water amount below zero becomes impossible.\"}),\"\\n\",n(a.h2,{id:\"read-only-power\",children:n(a.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#read-only-power\",children:n(a.a,{href:\"#read-only-power\",children:\"Read-only “power”\"})})}),\"\\n\",l(a.p,{children:[\"For \",n(a.code,{children:\"power\"}),\" property, let’s make it read-only. It sometimes happens that a property must be set at creation time only, and then never modified.\"]}),\"\\n\",n(a.p,{children:\"That’s exactly the case for a coffee machine: power never changes.\"}),\"\\n\",n(a.p,{children:\"To do so, we only need to make getter, but not the setter:\"}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"  // ...\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  constructor\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_power\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  get\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    return\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// create the coffee machine\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" coffeeMachine\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#C678DD\"},children:\" new\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#D19A66\"},children:\"100\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"alert\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#98C379\"},children:\"`Power is: \"}),n(a.span,{style:{color:\"#C678DD\"},children:\"${\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\"coffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"power\"}),n(a.span,{style:{color:\"#C678DD\"},children:\"}\"}),n(a.span,{style:{color:\"#98C379\"},children:\"W`\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"); \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Power is: 100W\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"coffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"power\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 25\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"; \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Error (no setter)\"})]})]})})}),\"\\n\",n(a.p,{children:n(a.strong,{children:\"Getter/setter functions\"})}),\"\\n\",n(a.p,{children:\"Here we used getter/setter syntax.\"}),\"\\n\",l(a.p,{children:[\"But most of the time \",n(a.code,{children:\"get.../set...\"}),\" functions are preferred, like this:\"]}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E06C75\"},children:\"  _waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"  setWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    if\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" <\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") \"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"  getWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    return\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"new\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"().\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\"setWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#D19A66\"},children:\"100\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\");\"})]})]})})}),\"\\n\",n(a.p,{children:\"That looks a bit longer, but functions are more flexible. They can accept multiple arguments (even if we don’t need them right now).\"}),\"\\n\",n(a.p,{children:\"On the other hand, get/set syntax is shorter, so ultimately there’s no strict rule, it’s up to you to decide.\"}),\"\\n\",n(a.p,{children:n(a.strong,{children:\"Protected fields are inherited\"})}),\"\\n\",l(a.p,{children:[\"If we inherit \",n(a.code,{children:\"class MegaMachine extends CoffeeMachine\"}),\", then nothing prevents us from accessing \",n(a.code,{children:\"this._waterAmount\"}),\" or \",n(a.code,{children:\"this._power\"}),\" from the methods of the new class.\"]}),\"\\n\",n(a.p,{children:\"So protected fields are naturally inheritable. Unlike private ones that we’ll see below.\"}),\"\\n\",n(a.h2,{id:\"private-waterlimit\",children:n(a.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#private-waterlimit\",children:n(a.a,{href:\"#private-waterlimit\",children:\"Private “#waterLimit”\"})})}),\"\\n\",n(a.p,{children:n(a.strong,{children:\"A recent addition\"})}),\"\\n\",l(a.p,{children:[\"This is a recent addition to the language. Not supported in JavaScript engines, or supported partially yet, requires \",n(a.a,{href:\"https://javascript.info/polyfills\",children:\"polyfilling\"}),\".\"]}),\"\\n\",n(a.p,{children:\"There’s a finished JavaScript proposal, almost in the standard, that provides language-level support for private properties and methods.\"}),\"\\n\",l(a.p,{children:[\"Privates should start with \",n(a.code,{children:\"#\"}),\". They are only accessible from inside the class.\"]}),\"\\n\",l(a.p,{children:[\"For instance, here’s a private \",n(a.code,{children:\"#waterLimit\"}),\" property and the water-checking private method \",n(a.code,{children:\"#fixWaterAmount\"}),\":\"]}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E06C75\"},children:\"  #waterLimit\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 200\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#ABB2BF\"},children:\"  #\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\"fixWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    if\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" <\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") \"}),n(a.span,{style:{color:\"#C678DD\"},children:\"return\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    if\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" >\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterLimit\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") \"}),n(a.span,{style:{color:\"#C678DD\"},children:\"return\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterLimit\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"  setWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterLimit\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\"#fixWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" coffeeMachine\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#C678DD\"},children:\" new\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"();\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// can't access privates from outside of the class\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"coffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\"#fixWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#D19A66\"},children:\"123\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"); \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Error\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"coffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterLimit\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 1000\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"; \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Error\"})]})]})})}),\"\\n\",l(a.p,{children:[\"On the language level, \",n(a.code,{children:\"#\"}),\" is a special sign that the field is private. We can’t access it from outside or from inheriting classes.\"]}),\"\\n\",l(a.p,{children:[\"Private fields do not conflict with public ones. We can have both private \",n(a.code,{children:\"#waterAmount\"}),\" and public \",n(a.code,{children:\"waterAmount\"}),\" fields at the same time.\"]}),\"\\n\",l(a.p,{children:[\"For instance, let’s make \",n(a.code,{children:\"waterAmount\"}),\" an accessor for \",n(a.code,{children:\"#waterAmount\"}),\":\"]}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E06C75\"},children:\"  #waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  get\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    return\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  set\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    if\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" <\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") \"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" machine\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#C678DD\"},children:\" new\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"();\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"machine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 100\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"alert\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\"machine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"); \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Error\"})]})]})})}),\"\\n\",n(a.p,{children:\"Unlike protected ones, private fields are enforced by the language itself. That’s a good thing.\"}),\"\\n\",l(a.p,{children:[\"But if we inherit from \",n(a.code,{children:\"CoffeeMachine\"}),\", then we’ll have no direct access to \",n(a.code,{children:\"#waterAmount\"}),\". We’ll need to rely on \",n(a.code,{children:\"waterAmount\"}),\" getter/setter:\"]}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" MegaCoffeeMachine\"}),n(a.span,{style:{color:\"#C678DD\"},children:\" extends\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"  method\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"    alert\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"( \"}),n(a.span,{style:{color:\"#E5C07B\"},children:\"this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" ); \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Error: can only access from CoffeeMachine\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",l(a.p,{children:[\"In many scenarios such limitation is too severe. If we extend a \",n(a.code,{children:\"CoffeeMachine\"}),\", we may have legitimate reasons to access its internals. That’s why protected fields are used more often, even though they are not supported by the language syntax.\"]}),\"\\n\",n(a.p,{children:n(a.strong,{children:\"Private fields are not available as this[name]\"})}),\"\\n\",n(a.p,{children:\"Private fields are special.\"}),\"\\n\",l(a.p,{children:[\"As we know, usually we can access fields using \",n(a.code,{children:\"this[name]\"}),\":\"]}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" User\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  ...\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"  sayHi\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    let\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" fieldName\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#98C379\"},children:' \"name\"'}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"    alert\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#98C379\"},children:\"`Hello, \"}),n(a.span,{style:{color:\"#C678DD\"},children:\"${\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\"this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"[\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"fieldName\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"]\"}),n(a.span,{style:{color:\"#C678DD\"},children:\"}\"}),n(a.span,{style:{color:\"#98C379\"},children:\"`\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",l(a.p,{children:[\"With private fields that’s impossible: \",n(a.code,{children:\"this['#name']\"}),\" doesn’t work. That’s a syntax limitation to ensure privacy.\"]}),\"\\n\",n(a.h2,{id:\"summary\",children:n(a.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#summary\",children:n(a.a,{href:\"#summary\",children:\"Summary\"})})}),\"\\n\",l(a.p,{children:[\"In terms of OOP, delimiting of the internal interface from the external one is called \",n(a.a,{href:\"https://en.wikipedia.org/wiki/Encapsulation_(computer_programming)\",children:\"encapsulation\"}),\".\"]}),\"\\n\",n(a.p,{children:\"It gives the following benefits:\"}),\"\\n\",l(a.ul,{children:[\"\\n\",l(a.li,{children:[\"\\n\",n(a.p,{children:\"Protection for users, so that they don’t shoot themselves in the foot\"}),\"\\n\",n(a.p,{children:\"Imagine, there’s a team of developers using a coffee machine. It was made by the “Best CoffeeMachine” company, and works fine, but a protective cover was removed. So the internal interface is exposed.All developers are civilized – they use the coffee machine as intended. But one of them, John, decided that he’s the smartest one, and made some tweaks in the coffee machine internals. So the coffee machine failed two days later.That’s surely not John’s fault, but rather the person who removed the protective cover and let John do his manipulations.The same in programming. If a user of a class will change things not intended to be changed from the outside – the consequences are unpredictable.\"}),\"\\n\"]}),\"\\n\",l(a.li,{children:[\"\\n\",n(a.p,{children:\"Supportable\"}),\"\\n\",n(a.p,{children:\"The situation in programming is more complex than with a real-life coffee machine, because we don’t just buy it once. The code constantly undergoes development and improvement.**If we strictly delimit the internal interface, then the developer of the class can freely change its internal properties and methods, even without informing the users.**If you’re a developer of such class, it’s great to know that private methods can be safely renamed, their parameters can be changed, and even removed, because no external code depends on them.For users, when a new version comes out, it may be a total overhaul internally, but still simple to upgrade if the external interface is the same.\"}),\"\\n\"]}),\"\\n\",l(a.li,{children:[\"\\n\",n(a.p,{children:\"Hiding complexity\"}),\"\\n\",l(a.p,{children:[\"People adore using things that are simple. At least from outside. What’s inside is a different thing.Programmers are not an exception.\",n(a.strong,{children:\"It’s always convenient when implementation details are hidden, and a simple, well-documented external interface is available.\"})]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(a.p,{children:\"To hide an internal interface we use either protected or private properties:\"}),\"\\n\",l(a.ul,{children:[\"\\n\",l(a.li,{children:[\"Protected fields start with \",n(a.code,{children:\"_\"}),\". That’s a well-known convention, not enforced at the language level. Programmers should only access a field starting with \",n(a.code,{children:\"_\"}),\" from its class and classes inheriting from it.\"]}),\"\\n\",l(a.li,{children:[\"Private fields start with \",n(a.code,{children:\"#\"}),\". JavaScript makes sure we can only access those from inside the class.\"]}),\"\\n\"]}),\"\\n\",n(a.p,{children:\"Right now, private fields are not well-supported among browsers, but can be polyfilled.\"})]})}return{default:function(e={}){const{wrapper:l}=e.components||{};return l?n(l,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};","title":"Private and protected properties and methods","description":"复制自javascript.info","date":"2025-03-30T00:00:00.000Z","published":true,"body":"const{Fragment:e,jsx:n,jsxs:l}=arguments[0];function _createMdxContent(r){const a={a:\"a\",code:\"code\",em:\"em\",figure:\"figure\",h2:\"h2\",img:\"img\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...r.components};return l(e,{children:[n(a.p,{children:\"One of the most important principles of object oriented programming – delimiting internal interface from the external one.\"}),\"\\n\",n(a.p,{children:\"That is “a must” practice in developing anything more complex than a “hello world” app.\"}),\"\\n\",n(a.p,{children:\"To understand this, let’s break away from development and turn our eyes into the real world.\"}),\"\\n\",n(a.p,{children:\"Usually, devices that we’re using are quite complex. But delimiting the internal interface from the external one allows to use them without problems.\"}),\"\\n\",n(a.h2,{id:\"a-real-life-example\",children:n(a.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#a-real-life-example\",children:n(a.a,{href:\"#a-real-life-example\",children:\"A real-life example\"})})}),\"\\n\",n(a.p,{children:\"For instance, a coffee machine. Simple from outside: a button, a display, a few holes…And, surely, the result – great coffee! :)\"}),\"\\n\",n(a.p,{children:\"But inside… (a picture from the repair manual)\"}),\"\\n\",n(a.p,{children:n(a.img,{src:\"https://javascript.info/article/private-protected-properties-methods/coffee-inside.jpg\",alt:\"img\"})}),\"\\n\",n(a.p,{children:\"A lot of details. But we can use it without knowing anything.\"}),\"\\n\",n(a.p,{children:\"Coffee machines are quite reliable, aren’t they? We can use one for years, and only if something goes wrong – bring it for repairs.\"}),\"\\n\",l(a.p,{children:[\"The secret of reliability and simplicity of a coffee machine – all details are well-tuned and \",n(a.em,{children:\"hidden\"}),\" inside.\"]}),\"\\n\",n(a.p,{children:\"If we remove the protective cover from the coffee machine, then using it will be much more complex (where to press?), and dangerous (it can electrocute).\"}),\"\\n\",n(a.p,{children:\"As we’ll see, in programming objects are like coffee machines.\"}),\"\\n\",n(a.p,{children:\"But in order to hide inner details, we’ll use not a protective cover, but rather special syntax of the language and conventions.\"}),\"\\n\",n(a.h2,{id:\"internal-and-external-interface\",children:n(a.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#internal-and-external-interface\",children:n(a.a,{href:\"#internal-and-external-interface\",children:\"Internal and external interface\"})})}),\"\\n\",n(a.p,{children:\"In object-oriented programming, properties and methods are split into two groups:\"}),\"\\n\",l(a.ul,{children:[\"\\n\",l(a.li,{children:[n(a.em,{children:\"Internal interface\"}),\" – methods and properties, accessible from other methods of the class, but not from the outside.\"]}),\"\\n\",l(a.li,{children:[n(a.em,{children:\"External interface\"}),\" – methods and properties, accessible also from outside the class.\"]}),\"\\n\"]}),\"\\n\",n(a.p,{children:\"If we continue the analogy with the coffee machine – what’s hidden inside: a boiler tube, heating element, and so on – is its internal interface.\"}),\"\\n\",n(a.p,{children:\"An internal interface is used for the object to work, its details use each other. For instance, a boiler tube is attached to the heating element.\"}),\"\\n\",n(a.p,{children:\"But from the outside a coffee machine is closed by the protective cover, so that no one can reach those. Details are hidden and inaccessible. We can use its features via the external interface.\"}),\"\\n\",n(a.p,{children:\"So, all we need to use an object is to know its external interface. We may be completely unaware how it works inside, and that’s great.\"}),\"\\n\",n(a.p,{children:\"That was a general introduction.\"}),\"\\n\",n(a.p,{children:\"In JavaScript, there are two types of object fields (properties and methods):\"}),\"\\n\",l(a.ul,{children:[\"\\n\",n(a.li,{children:\"Public: accessible from anywhere. They comprise the external interface. Until now we were only using public properties and methods.\"}),\"\\n\",n(a.li,{children:\"Private: accessible only from inside the class. These are for the internal interface.\"}),\"\\n\"]}),\"\\n\",n(a.p,{children:\"In many other languages there also exist “protected” fields: accessible only from inside the class and those extending it (like private, but plus access from inheriting classes). They are also useful for the internal interface. They are in a sense more widespread than private ones, because we usually want inheriting classes to gain access to them.\"}),\"\\n\",n(a.p,{children:\"Protected fields are not implemented in JavaScript on the language level, but in practice they are very convenient, so they are emulated.\"}),\"\\n\",n(a.p,{children:\"Now we’ll make a coffee machine in JavaScript with all these types of properties. A coffee machine has a lot of details, we won’t model them to stay simple (though we could).\"}),\"\\n\",n(a.h2,{id:\"protecting-wateramount\",children:n(a.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#protecting-wateramount\",children:n(a.a,{href:\"#protecting-wateramount\",children:\"Protecting “waterAmount”\"})})}),\"\\n\",n(a.p,{children:\"Let’s make a simple coffee machine class first:\"}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E06C75\"},children:\"  waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"; \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// the amount of water inside\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  constructor\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"power\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"    alert\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"( \"}),n(a.span,{style:{color:\"#98C379\"},children:\"`Created a coffee-machine, power: \"}),n(a.span,{style:{color:\"#C678DD\"},children:\"${\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"power\"}),n(a.span,{style:{color:\"#C678DD\"},children:\"}\"}),n(a.span,{style:{color:\"#98C379\"},children:\"`\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" );\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// create the coffee machine\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" coffeeMachine\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#C678DD\"},children:\" new\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#D19A66\"},children:\"100\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// add water\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"coffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 200\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]})]})})}),\"\\n\",l(a.p,{children:[\"Right now the properties \",n(a.code,{children:\"waterAmount\"}),\" and \",n(a.code,{children:\"power\"}),\" are public. We can easily get/set them from the outside to any value.\"]}),\"\\n\",l(a.p,{children:[\"Let’s change \",n(a.code,{children:\"waterAmount\"}),\" property to protected to have more control over it. For instance, we don’t want anyone to set it below zero.\"]}),\"\\n\",n(a.p,{children:l(a.strong,{children:[\"Protected properties are usually prefixed with an underscore \",n(a.code,{children:\"_\"}),\".\"]})}),\"\\n\",n(a.p,{children:\"That is not enforced on the language level, but there’s a well-known convention between programmers that such properties and methods should not be accessed from the outside.\"}),\"\\n\",l(a.p,{children:[\"So our property will be called \",n(a.code,{children:\"_waterAmount\"}),\":\"]}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E06C75\"},children:\"  _waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  set\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    if\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" <\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E06C75\"},children:\"      value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"    }\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  get\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    return\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  constructor\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_power\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// create the coffee machine\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" coffeeMachine\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#C678DD\"},children:\" new\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#D19A66\"},children:\"100\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// add water\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"coffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" -\"}),n(a.span,{style:{color:\"#D19A66\"},children:\"10\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"; \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// _waterAmount will become 0, not -10\"})]})]})})}),\"\\n\",n(a.p,{children:\"Now the access is under control, so setting the water amount below zero becomes impossible.\"}),\"\\n\",n(a.h2,{id:\"read-only-power\",children:n(a.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#read-only-power\",children:n(a.a,{href:\"#read-only-power\",children:\"Read-only “power”\"})})}),\"\\n\",l(a.p,{children:[\"For \",n(a.code,{children:\"power\"}),\" property, let’s make it read-only. It sometimes happens that a property must be set at creation time only, and then never modified.\"]}),\"\\n\",n(a.p,{children:\"That’s exactly the case for a coffee machine: power never changes.\"}),\"\\n\",n(a.p,{children:\"To do so, we only need to make getter, but not the setter:\"}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"  // ...\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  constructor\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_power\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  get\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    return\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_power\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// create the coffee machine\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" coffeeMachine\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#C678DD\"},children:\" new\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#D19A66\"},children:\"100\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"alert\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#98C379\"},children:\"`Power is: \"}),n(a.span,{style:{color:\"#C678DD\"},children:\"${\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\"coffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"power\"}),n(a.span,{style:{color:\"#C678DD\"},children:\"}\"}),n(a.span,{style:{color:\"#98C379\"},children:\"W`\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"); \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Power is: 100W\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"coffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"power\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 25\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"; \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Error (no setter)\"})]})]})})}),\"\\n\",n(a.p,{children:n(a.strong,{children:\"Getter/setter functions\"})}),\"\\n\",n(a.p,{children:\"Here we used getter/setter syntax.\"}),\"\\n\",l(a.p,{children:[\"But most of the time \",n(a.code,{children:\"get.../set...\"}),\" functions are preferred, like this:\"]}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E06C75\"},children:\"  _waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"  setWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    if\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" <\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") \"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"  getWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    return\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"_waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"new\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"().\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\"setWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#D19A66\"},children:\"100\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\");\"})]})]})})}),\"\\n\",n(a.p,{children:\"That looks a bit longer, but functions are more flexible. They can accept multiple arguments (even if we don’t need them right now).\"}),\"\\n\",n(a.p,{children:\"On the other hand, get/set syntax is shorter, so ultimately there’s no strict rule, it’s up to you to decide.\"}),\"\\n\",n(a.p,{children:n(a.strong,{children:\"Protected fields are inherited\"})}),\"\\n\",l(a.p,{children:[\"If we inherit \",n(a.code,{children:\"class MegaMachine extends CoffeeMachine\"}),\", then nothing prevents us from accessing \",n(a.code,{children:\"this._waterAmount\"}),\" or \",n(a.code,{children:\"this._power\"}),\" from the methods of the new class.\"]}),\"\\n\",n(a.p,{children:\"So protected fields are naturally inheritable. Unlike private ones that we’ll see below.\"}),\"\\n\",n(a.h2,{id:\"private-waterlimit\",children:n(a.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#private-waterlimit\",children:n(a.a,{href:\"#private-waterlimit\",children:\"Private “#waterLimit”\"})})}),\"\\n\",n(a.p,{children:n(a.strong,{children:\"A recent addition\"})}),\"\\n\",l(a.p,{children:[\"This is a recent addition to the language. Not supported in JavaScript engines, or supported partially yet, requires \",n(a.a,{href:\"https://javascript.info/polyfills\",children:\"polyfilling\"}),\".\"]}),\"\\n\",n(a.p,{children:\"There’s a finished JavaScript proposal, almost in the standard, that provides language-level support for private properties and methods.\"}),\"\\n\",l(a.p,{children:[\"Privates should start with \",n(a.code,{children:\"#\"}),\". They are only accessible from inside the class.\"]}),\"\\n\",l(a.p,{children:[\"For instance, here’s a private \",n(a.code,{children:\"#waterLimit\"}),\" property and the water-checking private method \",n(a.code,{children:\"#fixWaterAmount\"}),\":\"]}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E06C75\"},children:\"  #waterLimit\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 200\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#ABB2BF\"},children:\"  #\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\"fixWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    if\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" <\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") \"}),n(a.span,{style:{color:\"#C678DD\"},children:\"return\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    if\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" >\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterLimit\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") \"}),n(a.span,{style:{color:\"#C678DD\"},children:\"return\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterLimit\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"  setWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterLimit\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\"#fixWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" coffeeMachine\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#C678DD\"},children:\" new\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"();\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// can't access privates from outside of the class\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"coffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\"#fixWaterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#D19A66\"},children:\"123\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"); \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Error\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"coffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterLimit\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 1000\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"; \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Error\"})]})]})})}),\"\\n\",l(a.p,{children:[\"On the language level, \",n(a.code,{children:\"#\"}),\" is a special sign that the field is private. We can’t access it from outside or from inheriting classes.\"]}),\"\\n\",l(a.p,{children:[\"Private fields do not conflict with public ones. We can have both private \",n(a.code,{children:\"#waterAmount\"}),\" and public \",n(a.code,{children:\"waterAmount\"}),\" fields at the same time.\"]}),\"\\n\",l(a.p,{children:[\"For instance, let’s make \",n(a.code,{children:\"waterAmount\"}),\" an accessor for \",n(a.code,{children:\"#waterAmount\"}),\":\"]}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E06C75\"},children:\"  #waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  get\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    return\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"  set\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    if\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" <\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\") \"}),n(a.span,{style:{color:\"#E06C75\"},children:\"value\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 0\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"    this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" value\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"let\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" machine\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#C678DD\"},children:\" new\"}),n(a.span,{style:{color:\"#61AFEF\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"();\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#E5C07B\"},children:\"machine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"waterAmount\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#D19A66\"},children:\" 100\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"alert\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\"machine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"); \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Error\"})]})]})})}),\"\\n\",n(a.p,{children:\"Unlike protected ones, private fields are enforced by the language itself. That’s a good thing.\"}),\"\\n\",l(a.p,{children:[\"But if we inherit from \",n(a.code,{children:\"CoffeeMachine\"}),\", then we’ll have no direct access to \",n(a.code,{children:\"#waterAmount\"}),\". We’ll need to rely on \",n(a.code,{children:\"waterAmount\"}),\" getter/setter:\"]}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" MegaCoffeeMachine\"}),n(a.span,{style:{color:\"#C678DD\"},children:\" extends\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" CoffeeMachine\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"  method\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"    alert\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"( \"}),n(a.span,{style:{color:\"#E5C07B\"},children:\"this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\".\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"#waterAmount\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" ); \"}),n(a.span,{style:{color:\"#7F848E\",fontStyle:\"italic\"},children:\"// Error: can only access from CoffeeMachine\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",l(a.p,{children:[\"In many scenarios such limitation is too severe. If we extend a \",n(a.code,{children:\"CoffeeMachine\"}),\", we may have legitimate reasons to access its internals. That’s why protected fields are used more often, even though they are not supported by the language syntax.\"]}),\"\\n\",n(a.p,{children:n(a.strong,{children:\"Private fields are not available as this[name]\"})}),\"\\n\",n(a.p,{children:\"Private fields are special.\"}),\"\\n\",l(a.p,{children:[\"As we know, usually we can access fields using \",n(a.code,{children:\"this[name]\"}),\":\"]}),\"\\n\",n(a.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(a.pre,{style:{backgroundColor:\"#282c34\",color:\"#abb2bf\"},tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",children:l(a.code,{\"data-language\":\"javascript\",\"data-theme\":\"one-dark-pro\",style:{display:\"grid\"},children:[l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"class\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\" User\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  ...\"})}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"  sayHi\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"() {\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#C678DD\"},children:\"    let\"}),n(a.span,{style:{color:\"#E06C75\"},children:\" fieldName\"}),n(a.span,{style:{color:\"#56B6C2\"},children:\" =\"}),n(a.span,{style:{color:\"#98C379\"},children:' \"name\"'}),n(a.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),\"\\n\",l(a.span,{\"data-line\":\"\",children:[n(a.span,{style:{color:\"#61AFEF\"},children:\"    alert\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),n(a.span,{style:{color:\"#98C379\"},children:\"`Hello, \"}),n(a.span,{style:{color:\"#C678DD\"},children:\"${\"}),n(a.span,{style:{color:\"#E5C07B\"},children:\"this\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"[\"}),n(a.span,{style:{color:\"#E06C75\"},children:\"fieldName\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\"]\"}),n(a.span,{style:{color:\"#C678DD\"},children:\"}\"}),n(a.span,{style:{color:\"#98C379\"},children:\"`\"}),n(a.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"  }\"})}),\"\\n\",n(a.span,{\"data-line\":\"\",children:n(a.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),\"\\n\",l(a.p,{children:[\"With private fields that’s impossible: \",n(a.code,{children:\"this['#name']\"}),\" doesn’t work. That’s a syntax limitation to ensure privacy.\"]}),\"\\n\",n(a.h2,{id:\"summary\",children:n(a.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#summary\",children:n(a.a,{href:\"#summary\",children:\"Summary\"})})}),\"\\n\",l(a.p,{children:[\"In terms of OOP, delimiting of the internal interface from the external one is called \",n(a.a,{href:\"https://en.wikipedia.org/wiki/Encapsulation_(computer_programming)\",children:\"encapsulation\"}),\".\"]}),\"\\n\",n(a.p,{children:\"It gives the following benefits:\"}),\"\\n\",l(a.ul,{children:[\"\\n\",l(a.li,{children:[\"\\n\",n(a.p,{children:\"Protection for users, so that they don’t shoot themselves in the foot\"}),\"\\n\",n(a.p,{children:\"Imagine, there’s a team of developers using a coffee machine. It was made by the “Best CoffeeMachine” company, and works fine, but a protective cover was removed. So the internal interface is exposed.All developers are civilized – they use the coffee machine as intended. But one of them, John, decided that he’s the smartest one, and made some tweaks in the coffee machine internals. So the coffee machine failed two days later.That’s surely not John’s fault, but rather the person who removed the protective cover and let John do his manipulations.The same in programming. If a user of a class will change things not intended to be changed from the outside – the consequences are unpredictable.\"}),\"\\n\"]}),\"\\n\",l(a.li,{children:[\"\\n\",n(a.p,{children:\"Supportable\"}),\"\\n\",n(a.p,{children:\"The situation in programming is more complex than with a real-life coffee machine, because we don’t just buy it once. The code constantly undergoes development and improvement.**If we strictly delimit the internal interface, then the developer of the class can freely change its internal properties and methods, even without informing the users.**If you’re a developer of such class, it’s great to know that private methods can be safely renamed, their parameters can be changed, and even removed, because no external code depends on them.For users, when a new version comes out, it may be a total overhaul internally, but still simple to upgrade if the external interface is the same.\"}),\"\\n\"]}),\"\\n\",l(a.li,{children:[\"\\n\",n(a.p,{children:\"Hiding complexity\"}),\"\\n\",l(a.p,{children:[\"People adore using things that are simple. At least from outside. What’s inside is a different thing.Programmers are not an exception.\",n(a.strong,{children:\"It’s always convenient when implementation details are hidden, and a simple, well-documented external interface is available.\"})]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(a.p,{children:\"To hide an internal interface we use either protected or private properties:\"}),\"\\n\",l(a.ul,{children:[\"\\n\",l(a.li,{children:[\"Protected fields start with \",n(a.code,{children:\"_\"}),\". That’s a well-known convention, not enforced at the language level. Programmers should only access a field starting with \",n(a.code,{children:\"_\"}),\" from its class and classes inheriting from it.\"]}),\"\\n\",l(a.li,{children:[\"Private fields start with \",n(a.code,{children:\"#\"}),\". JavaScript makes sure we can only access those from inside the class.\"]}),\"\\n\"]}),\"\\n\",n(a.p,{children:\"Right now, private fields are not well-supported among browsers, but can be polyfilled.\"})]})}return{default:function(e={}){const{wrapper:l}=e.components||{};return l?n(l,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};","slugAsParams":"private-protected-properties-methods"},{"slug":"blog/React19_features","code":"const{Fragment:e,jsx:n,jsxs:t}=arguments[0];function _createMdxContent(i){const a={code:\"code\",p:\"p\",...i.components};return t(e,{children:[n(a.p,{children:\"This version brought significant changes, focusing heavily on performance improvements via the React Compiler and enhanced developer experience, particularly around data handling and asynchronous operations.  \"}),\"\\n\",n(a.p,{children:\"Here are the major features of React 19:\"}),\"\\n\",n(a.p,{children:\"React Compiler (Major Highlight):\"}),\"\\n\",n(a.p,{children:\"What it is: This is an optimizing compiler that React now uses ahead-of-time during your build process. Previously, React relied solely on runtime interpretation.\\r\\nCore Benefit: It automatically optimizes your React code, specifically by handling memoization implicitly. This means you often no longer need to manually use hooks like useMemo, useCallback, and React.memo to prevent unnecessary re-renders.  \\r\\nImpact:\\r\\nImproved Runtime Performance: Components re-render less often without manual optimization, leading to faster applications.  \\r\\nSimplified Code: Developers write less boilerplate code related to memoization, making components cleaner and easier to maintain.  \\r\\nEasier Learning Curve: New developers don't need to immediately grapple with the complexities of manual memoization hooks.\\r\\nNote: The compiler is designed to be safe and understands React's rules. It won't change the underlying logic of your code, only optimize its execution. It's opt-in initially but is the future direction.  \\r\\nActions:\"}),\"\\n\",t(a.p,{children:[\"What they are: A new mechanism for handling data mutations, especially form submissions and interactions that involve server-side changes. Actions can be passed directly to form elements (\",n(a.code,{children:\"<form action={...}>\"}),') or invoked programmatically.  \\r\\nCore Benefit: Simplifies managing the lifecycle of asynchronous operations (like fetching data or submitting forms). React automatically handles pending states, responses, and potential errors.  \\r\\nIntegration: Works seamlessly with async/await and integrates with React\\'s concurrent features like Transitions (useTransition). This allows UI updates related to the action (like showing spinners or results) without blocking the user interface.  \\r\\nServer Actions: Actions can also be defined on the server (using the \"use server\" directive) when using frameworks that support React Server Components (like Next.js), allowing client components to directly call server-side logic securely.\\r\\nNew Hooks Supporting Actions:']}),\"\\n\",t(a.p,{children:[\"useActionState (formerly useFormState in canary):\\r\\nPurpose: Manages the state associated with an Action. It takes an action function and an initial state, returning the current state, the action function to be called, and a pending flag.  \\r\\nUse Case: Useful for displaying feedback (like success or error messages) directly related to the result of an action within the component that invoked it.  \\r\\n \\r\\nuseFormStatus:\\r\\nPurpose: Provides status information (pending state, data submitted, method used) about a parent form submission initiated by an Action.  \\r\\nUse Case: Crucial for components inside a \",n(a.code,{children:\"<form>\"}),' that need to react to the form\\'s submission status, such as disabling a submit button while the action is pending or showing a loading indicator next to it.\\r\\nuseOptimistic:\\r\\nPurpose: Allows you to immediately show a temporary (\"optimistic\") state update in the UI while an asynchronous action (like adding an item to a list) is still processing in the background. If the action succeeds, the optimistic state is confirmed; if it fails, the UI automatically reverts.  \\r\\nBenefit: Improves perceived performance and makes the UI feel more responsive during data updates.\\r\\nServer Components Features:']}),\"\\n\",n(a.p,{children:'While Server Components were introduced conceptually earlier, React 19 solidifies their integration and usage patterns, especially with Actions. Directives like \"use client\" (for client-side interactive components) and \"use server\" (for server-side Actions) become central to building hybrid applications.\\r\\nWeb Components Support:'}),\"\\n\",n(a.p,{children:\"Improved interoperability when using native Web Components within your React applications, making integration smoother.  \\r\\nAsset Loading Improvements:\"}),\"\\n\",n(a.p,{children:\"React 19 includes better support for loading assets like stylesheets, fonts, and scripts, integrating more deeply with Suspense. This means React can better manage the loading states of these assets, preventing visual glitches like flashes of unstyled content (FOUC).  \\r\\nDocument Metadata:\"}),\"\\n\",t(a.p,{children:[\"Built-in support for rendering document metadata tags (\",n(a.code,{children:\"<title>\"}),\", \",n(a.code,{children:\"<meta>\"}),\", \",n(a.code,{children:\"<link>\"}),\") directly within your component tree. This simplifies SEO and managing page head elements without relying on external libraries like Helmet.\\r\\nEnhanced ref Prop:\"]}),\"\\n\",n(a.p,{children:\"The ref prop now accepts a function that can return a cleanup function. This cleanup function runs when the component unmounts or the ref changes, simplifying scenarios where manual cleanup was previously needed with refs (e.g., detaching event listeners added via a ref).  \\r\\nIn summary, React 19 is a major step forward, primarily driven by the performance gains and code simplification offered by the React Compiler, alongside powerful new primitives like Actions and related hooks that significantly improve the developer experience for handling asynchronous operations and data mutations.\"})]})}return{default:function(e={}){const{wrapper:t}=e.components||{};return t?n(t,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};","title":"React 19 新特性","description":"使用gemini 2.5pro 生成","date":"2025-03-30T00:00:00.000Z","published":true,"body":"const{Fragment:e,jsx:n,jsxs:t}=arguments[0];function _createMdxContent(i){const a={code:\"code\",p:\"p\",...i.components};return t(e,{children:[n(a.p,{children:\"This version brought significant changes, focusing heavily on performance improvements via the React Compiler and enhanced developer experience, particularly around data handling and asynchronous operations.  \"}),\"\\n\",n(a.p,{children:\"Here are the major features of React 19:\"}),\"\\n\",n(a.p,{children:\"React Compiler (Major Highlight):\"}),\"\\n\",n(a.p,{children:\"What it is: This is an optimizing compiler that React now uses ahead-of-time during your build process. Previously, React relied solely on runtime interpretation.\\r\\nCore Benefit: It automatically optimizes your React code, specifically by handling memoization implicitly. This means you often no longer need to manually use hooks like useMemo, useCallback, and React.memo to prevent unnecessary re-renders.  \\r\\nImpact:\\r\\nImproved Runtime Performance: Components re-render less often without manual optimization, leading to faster applications.  \\r\\nSimplified Code: Developers write less boilerplate code related to memoization, making components cleaner and easier to maintain.  \\r\\nEasier Learning Curve: New developers don't need to immediately grapple with the complexities of manual memoization hooks.\\r\\nNote: The compiler is designed to be safe and understands React's rules. It won't change the underlying logic of your code, only optimize its execution. It's opt-in initially but is the future direction.  \\r\\nActions:\"}),\"\\n\",t(a.p,{children:[\"What they are: A new mechanism for handling data mutations, especially form submissions and interactions that involve server-side changes. Actions can be passed directly to form elements (\",n(a.code,{children:\"<form action={...}>\"}),') or invoked programmatically.  \\r\\nCore Benefit: Simplifies managing the lifecycle of asynchronous operations (like fetching data or submitting forms). React automatically handles pending states, responses, and potential errors.  \\r\\nIntegration: Works seamlessly with async/await and integrates with React\\'s concurrent features like Transitions (useTransition). This allows UI updates related to the action (like showing spinners or results) without blocking the user interface.  \\r\\nServer Actions: Actions can also be defined on the server (using the \"use server\" directive) when using frameworks that support React Server Components (like Next.js), allowing client components to directly call server-side logic securely.\\r\\nNew Hooks Supporting Actions:']}),\"\\n\",t(a.p,{children:[\"useActionState (formerly useFormState in canary):\\r\\nPurpose: Manages the state associated with an Action. It takes an action function and an initial state, returning the current state, the action function to be called, and a pending flag.  \\r\\nUse Case: Useful for displaying feedback (like success or error messages) directly related to the result of an action within the component that invoked it.  \\r\\n \\r\\nuseFormStatus:\\r\\nPurpose: Provides status information (pending state, data submitted, method used) about a parent form submission initiated by an Action.  \\r\\nUse Case: Crucial for components inside a \",n(a.code,{children:\"<form>\"}),' that need to react to the form\\'s submission status, such as disabling a submit button while the action is pending or showing a loading indicator next to it.\\r\\nuseOptimistic:\\r\\nPurpose: Allows you to immediately show a temporary (\"optimistic\") state update in the UI while an asynchronous action (like adding an item to a list) is still processing in the background. If the action succeeds, the optimistic state is confirmed; if it fails, the UI automatically reverts.  \\r\\nBenefit: Improves perceived performance and makes the UI feel more responsive during data updates.\\r\\nServer Components Features:']}),\"\\n\",n(a.p,{children:'While Server Components were introduced conceptually earlier, React 19 solidifies their integration and usage patterns, especially with Actions. Directives like \"use client\" (for client-side interactive components) and \"use server\" (for server-side Actions) become central to building hybrid applications.\\r\\nWeb Components Support:'}),\"\\n\",n(a.p,{children:\"Improved interoperability when using native Web Components within your React applications, making integration smoother.  \\r\\nAsset Loading Improvements:\"}),\"\\n\",n(a.p,{children:\"React 19 includes better support for loading assets like stylesheets, fonts, and scripts, integrating more deeply with Suspense. This means React can better manage the loading states of these assets, preventing visual glitches like flashes of unstyled content (FOUC).  \\r\\nDocument Metadata:\"}),\"\\n\",t(a.p,{children:[\"Built-in support for rendering document metadata tags (\",n(a.code,{children:\"<title>\"}),\", \",n(a.code,{children:\"<meta>\"}),\", \",n(a.code,{children:\"<link>\"}),\") directly within your component tree. This simplifies SEO and managing page head elements without relying on external libraries like Helmet.\\r\\nEnhanced ref Prop:\"]}),\"\\n\",n(a.p,{children:\"The ref prop now accepts a function that can return a cleanup function. This cleanup function runs when the component unmounts or the ref changes, simplifying scenarios where manual cleanup was previously needed with refs (e.g., detaching event listeners added via a ref).  \\r\\nIn summary, React 19 is a major step forward, primarily driven by the performance gains and code simplification offered by the React Compiler, alongside powerful new primitives like Actions and related hooks that significantly improve the developer experience for handling asynchronous operations and data mutations.\"})]})}return{default:function(e={}){const{wrapper:t}=e.components||{};return t?n(t,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};","slugAsParams":"React19_features"},{"slug":"blog/react_vs_vue","code":"const{Fragment:e,jsx:t,jsxs:i}=arguments[0];function _createMdxContent(n){const a={p:\"p\",...n.components};return i(e,{children:[t(a.p,{children:\"First, let's address your premises:\"}),\"\\n\",t(a.p,{children:'\"Vue.js being more performant\": This isn\\'t universally true, although Vue often has a reputation for excellent performance, particularly regarding its virtual DOM implementation and optimizations.'}),\"\\n\",t(a.p,{children:'Reality: Both React and Vue are extremely performant JavaScript frameworks. Performance differences in real-world applications are often negligible and depend far more on how the application is built (code splitting, component optimization, state management strategies, etc.) than on the core framework itself. Benchmarks might show slight advantages for one over the other in specific micro-tasks, but these rarely translate into significant user-perceived differences in well-architected apps. Both have undergone significant performance improvements over the years.\\r\\nCorrection: It\\'s more accurate to say both are highly performant, and choosing one solely based on minor benchmark differences is usually not practical.\\r\\n\"Vue.js being simpler\": Vue is often perceived as having a gentler learning curve, especially for developers familiar with traditional HTML, CSS, and JavaScript.  '}),\"\\n\",t(a.p,{children:\"Reality: Vue's template syntax feels very familiar to HTML, and its core concepts (like directives v-if, v-for) can be intuitive. Its official documentation is widely praised for clarity. React's use of JSX (embedding HTML-like syntax in JavaScript) and concepts like hooks can initially seem less straightforward to some, especially beginners.\\r\\nNuance: \\\"Simplicity\\\" is subjective. Some developers find React's approach of \\\"just JavaScript\\\" (once JSX is understood) and its functional programming paradigms cleaner in the long run, especially for complex state logic. Vue's \\\"magic\\\" (like reactive directives) can sometimes make debugging complex interactions harder for those accustomed to explicit JavaScript. Vue's Options API is often seen as simpler initially, while its Composition API (introduced later) is more comparable to React Hooks in complexity and power.  \\r\\nCorrection: While Vue often has a reputation for an easier initial learning curve, especially with its Options API and template syntax, the long-term simplicity depends on developer background and project complexity. React's explicitness can be seen as simpler by others once its core concepts are grasped.\\r\\nWhy People Choose React Despite Vue's Strengths:\"}),\"\\n\",t(a.p,{children:\"Even considering Vue's perceived easier learning curve and excellent performance, there are compelling reasons why many developers and companies choose React:\"}),\"\\n\",t(a.p,{children:\"Massive Ecosystem and Community: React has been around slightly longer in widespread use and benefits from a significantly larger community. This translates to:  \"}),\"\\n\",t(a.p,{children:\"More third-party libraries, tools, and components.\\r\\nMore tutorials, articles, courses, and Stack Overflow answers.\\r\\nA larger pool of developers available for hire.\\r\\nJob Market: Due to its widespread adoption, particularly in larger companies and startups (especially in the US), there are generally more job openings requesting React skills compared to Vue. This is a major driver for developers learning React.\"}),\"\\n\",t(a.p,{children:\"Corporate Backing and Stability: React is developed and maintained by Meta (Facebook). This strong corporate backing gives companies confidence in the framework's longevity, resources, and continued development. (Vue also has strong community backing and corporate usage, but Meta's influence is undeniable).  \"}),\"\\n\",t(a.p,{children:'Flexibility and Unopinionated Nature: React primarily focuses on the UI layer (\"the V in MVC\"). It doesn\\'t dictate choices for routing, state management, or build tooling. While this means more decisions need to be made upfront (e.g., choosing between Redux, Zustand, Jotai, MobX for state management), many developers prefer this flexibility to tailor the stack precisely to their needs. Vue, while also flexible, offers more official, integrated solutions (like Vue Router, Pinia/Vuex) which can feel more \"batteries-included\" but potentially less flexible for those wanting different approaches.  '}),\"\\n\",t(a.p,{children:\"React Native: For teams needing to develop native mobile applications alongside web applications, React Native offers a way to leverage existing React knowledge and potentially share some code (logic, not components directly). This is a significant advantage for cross-platform development strategies. Vue has native solutions like NativeScript-Vue or Weex, but React Native has broader adoption and a larger ecosystem.\"}),\"\\n\",t(a.p,{children:\"Developer Preference and Team Experience: Many developers learned React first and are simply more comfortable and productive with its patterns (JSX, hooks, component structure). Teams often choose technologies their members already know well.\"}),\"\\n\",t(a.p,{children:\"In Summary:\"}),\"\\n\",t(a.p,{children:'The choice between React and Vue isn\\'t usually about one being definitively \"better,\" \"faster,\" or \"simpler\" across the board.'}),\"\\n\",t(a.p,{children:\"Vue's Strengths often cited: Gentle initial learning curve (especially Options API), excellent documentation, great performance, well-integrated official companion libraries (Router, Pinia), clean Single File Components (.vue).\\r\\nReact's Strengths often cited: Huge ecosystem, massive community support, vast job market, strong corporate backing, flexibility in choosing architectural components, powerful ecosystem for mobile development (React Native).  \\r\\nPeople often choose React because of its larger ecosystem, job market dominance, the flexibility it offers, and the seamless path to mobile development via React Native, even if Vue might seem slightly easier to pick up initially for some. The decision often depends on project requirements, team expertise, long-term goals, and familiarity.\"})]})}return{default:function(e={}){const{wrapper:i}=e.components||{};return i?t(i,{...e,children:t(_createMdxContent,{...e})}):_createMdxContent(e)}};","title":"React.js vs Vue.js","description":"Prompt \"Why do people choose React over Vue.js despite Vue.js being more performant and simpler? Correct me if I’m wrong.\"","date":"2025-03-18T00:00:00.000Z","published":true,"body":"const{Fragment:e,jsx:t,jsxs:i}=arguments[0];function _createMdxContent(n){const a={p:\"p\",...n.components};return i(e,{children:[t(a.p,{children:\"First, let's address your premises:\"}),\"\\n\",t(a.p,{children:'\"Vue.js being more performant\": This isn\\'t universally true, although Vue often has a reputation for excellent performance, particularly regarding its virtual DOM implementation and optimizations.'}),\"\\n\",t(a.p,{children:'Reality: Both React and Vue are extremely performant JavaScript frameworks. Performance differences in real-world applications are often negligible and depend far more on how the application is built (code splitting, component optimization, state management strategies, etc.) than on the core framework itself. Benchmarks might show slight advantages for one over the other in specific micro-tasks, but these rarely translate into significant user-perceived differences in well-architected apps. Both have undergone significant performance improvements over the years.\\r\\nCorrection: It\\'s more accurate to say both are highly performant, and choosing one solely based on minor benchmark differences is usually not practical.\\r\\n\"Vue.js being simpler\": Vue is often perceived as having a gentler learning curve, especially for developers familiar with traditional HTML, CSS, and JavaScript.  '}),\"\\n\",t(a.p,{children:\"Reality: Vue's template syntax feels very familiar to HTML, and its core concepts (like directives v-if, v-for) can be intuitive. Its official documentation is widely praised for clarity. React's use of JSX (embedding HTML-like syntax in JavaScript) and concepts like hooks can initially seem less straightforward to some, especially beginners.\\r\\nNuance: \\\"Simplicity\\\" is subjective. Some developers find React's approach of \\\"just JavaScript\\\" (once JSX is understood) and its functional programming paradigms cleaner in the long run, especially for complex state logic. Vue's \\\"magic\\\" (like reactive directives) can sometimes make debugging complex interactions harder for those accustomed to explicit JavaScript. Vue's Options API is often seen as simpler initially, while its Composition API (introduced later) is more comparable to React Hooks in complexity and power.  \\r\\nCorrection: While Vue often has a reputation for an easier initial learning curve, especially with its Options API and template syntax, the long-term simplicity depends on developer background and project complexity. React's explicitness can be seen as simpler by others once its core concepts are grasped.\\r\\nWhy People Choose React Despite Vue's Strengths:\"}),\"\\n\",t(a.p,{children:\"Even considering Vue's perceived easier learning curve and excellent performance, there are compelling reasons why many developers and companies choose React:\"}),\"\\n\",t(a.p,{children:\"Massive Ecosystem and Community: React has been around slightly longer in widespread use and benefits from a significantly larger community. This translates to:  \"}),\"\\n\",t(a.p,{children:\"More third-party libraries, tools, and components.\\r\\nMore tutorials, articles, courses, and Stack Overflow answers.\\r\\nA larger pool of developers available for hire.\\r\\nJob Market: Due to its widespread adoption, particularly in larger companies and startups (especially in the US), there are generally more job openings requesting React skills compared to Vue. This is a major driver for developers learning React.\"}),\"\\n\",t(a.p,{children:\"Corporate Backing and Stability: React is developed and maintained by Meta (Facebook). This strong corporate backing gives companies confidence in the framework's longevity, resources, and continued development. (Vue also has strong community backing and corporate usage, but Meta's influence is undeniable).  \"}),\"\\n\",t(a.p,{children:'Flexibility and Unopinionated Nature: React primarily focuses on the UI layer (\"the V in MVC\"). It doesn\\'t dictate choices for routing, state management, or build tooling. While this means more decisions need to be made upfront (e.g., choosing between Redux, Zustand, Jotai, MobX for state management), many developers prefer this flexibility to tailor the stack precisely to their needs. Vue, while also flexible, offers more official, integrated solutions (like Vue Router, Pinia/Vuex) which can feel more \"batteries-included\" but potentially less flexible for those wanting different approaches.  '}),\"\\n\",t(a.p,{children:\"React Native: For teams needing to develop native mobile applications alongside web applications, React Native offers a way to leverage existing React knowledge and potentially share some code (logic, not components directly). This is a significant advantage for cross-platform development strategies. Vue has native solutions like NativeScript-Vue or Weex, but React Native has broader adoption and a larger ecosystem.\"}),\"\\n\",t(a.p,{children:\"Developer Preference and Team Experience: Many developers learned React first and are simply more comfortable and productive with its patterns (JSX, hooks, component structure). Teams often choose technologies their members already know well.\"}),\"\\n\",t(a.p,{children:\"In Summary:\"}),\"\\n\",t(a.p,{children:'The choice between React and Vue isn\\'t usually about one being definitively \"better,\" \"faster,\" or \"simpler\" across the board.'}),\"\\n\",t(a.p,{children:\"Vue's Strengths often cited: Gentle initial learning curve (especially Options API), excellent documentation, great performance, well-integrated official companion libraries (Router, Pinia), clean Single File Components (.vue).\\r\\nReact's Strengths often cited: Huge ecosystem, massive community support, vast job market, strong corporate backing, flexibility in choosing architectural components, powerful ecosystem for mobile development (React Native).  \\r\\nPeople often choose React because of its larger ecosystem, job market dominance, the flexibility it offers, and the seamless path to mobile development via React Native, even if Vue might seem slightly easier to pick up initially for some. The decision often depends on project requirements, team expertise, long-term goals, and familiarity.\"})]})}return{default:function(e={}){const{wrapper:i}=e.components||{};return i?t(i,{...e,children:t(_createMdxContent,{...e})}):_createMdxContent(e)}};","slugAsParams":"react_vs_vue"}]